{
  "cells": [
    {
      "cell_type": "code",
      "execution_count": 1,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "nBmbRQKASUQO",
        "outputId": "fb1b2ea9-d07b-4401-f05e-28a22b098948"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Mounted at /content/drive\n"
          ]
        }
      ],
      "source": [
        "from google.colab import drive\n",
        "drive.mount('/content/drive')"
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "from distutils.dir_util import copy_tree\n",
        "\n",
        "source_folder = '/content/drive/MyDrive/2025lg/data'\n",
        "destination_folder = '/content'\n",
        "\n",
        "copy_tree(source_folder, destination_folder)\n",
        "print(\"복사가 완료되었습니다.\")\n"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "5laWnGPVuS_1",
        "outputId": "e2cf6529-92f2-48a5-995f-73aff755607a"
      },
      "execution_count": 2,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "복사가 완료되었습니다.\n"
          ]
        }
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "wE9nTXTTwUm9"
      },
      "source": [
        "# Import & Install"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 3,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "hCMwmTsd1xyx",
        "outputId": "988f334f-9007-4c23-c8d1-a06d6ca4af71",
        "collapsed": true
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Collecting catboost\n",
            "  Downloading catboost-1.2.8-cp311-cp311-manylinux2014_x86_64.whl.metadata (1.2 kB)\n",
            "Requirement already satisfied: graphviz in /usr/local/lib/python3.11/dist-packages (from catboost) (0.21)\n",
            "Requirement already satisfied: matplotlib in /usr/local/lib/python3.11/dist-packages (from catboost) (3.10.0)\n",
            "Requirement already satisfied: numpy<3.0,>=1.16.0 in /usr/local/lib/python3.11/dist-packages (from catboost) (2.0.2)\n",
            "Requirement already satisfied: pandas>=0.24 in /usr/local/lib/python3.11/dist-packages (from catboost) (2.2.2)\n",
            "Requirement already satisfied: scipy in /usr/local/lib/python3.11/dist-packages (from catboost) (1.16.1)\n",
            "Requirement already satisfied: plotly in /usr/local/lib/python3.11/dist-packages (from catboost) (5.24.1)\n",
            "Requirement already satisfied: six in /usr/local/lib/python3.11/dist-packages (from catboost) (1.17.0)\n",
            "Requirement already satisfied: python-dateutil>=2.8.2 in /usr/local/lib/python3.11/dist-packages (from pandas>=0.24->catboost) (2.9.0.post0)\n",
            "Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.11/dist-packages (from pandas>=0.24->catboost) (2025.2)\n",
            "Requirement already satisfied: tzdata>=2022.7 in /usr/local/lib/python3.11/dist-packages (from pandas>=0.24->catboost) (2025.2)\n",
            "Requirement already satisfied: contourpy>=1.0.1 in /usr/local/lib/python3.11/dist-packages (from matplotlib->catboost) (1.3.3)\n",
            "Requirement already satisfied: cycler>=0.10 in /usr/local/lib/python3.11/dist-packages (from matplotlib->catboost) (0.12.1)\n",
            "Requirement already satisfied: fonttools>=4.22.0 in /usr/local/lib/python3.11/dist-packages (from matplotlib->catboost) (4.59.0)\n",
            "Requirement already satisfied: kiwisolver>=1.3.1 in /usr/local/lib/python3.11/dist-packages (from matplotlib->catboost) (1.4.8)\n",
            "Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.11/dist-packages (from matplotlib->catboost) (25.0)\n",
            "Requirement already satisfied: pillow>=8 in /usr/local/lib/python3.11/dist-packages (from matplotlib->catboost) (11.3.0)\n",
            "Requirement already satisfied: pyparsing>=2.3.1 in /usr/local/lib/python3.11/dist-packages (from matplotlib->catboost) (3.2.3)\n",
            "Requirement already satisfied: tenacity>=6.2.0 in /usr/local/lib/python3.11/dist-packages (from plotly->catboost) (8.5.0)\n",
            "Downloading catboost-1.2.8-cp311-cp311-manylinux2014_x86_64.whl (99.2 MB)\n",
            "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m99.2/99.2 MB\u001b[0m \u001b[31m8.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25hInstalling collected packages: catboost\n",
            "Successfully installed catboost-1.2.8\n"
          ]
        }
      ],
      "source": [
        "!pip install catboost"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 4,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "g2IvuMx29Ngs",
        "outputId": "1ec35aaf-b67b-4e5d-8079-5b22dcd7a4c5",
        "collapsed": true
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Requirement already satisfied: holidays in /usr/local/lib/python3.11/dist-packages (0.78)\n",
            "Requirement already satisfied: python-dateutil in /usr/local/lib/python3.11/dist-packages (from holidays) (2.9.0.post0)\n",
            "Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.11/dist-packages (from python-dateutil->holidays) (1.17.0)\n"
          ]
        }
      ],
      "source": [
        "!pip install holidays"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 5,
      "metadata": {
        "id": "LU9ZQ1bwwUnD"
      },
      "outputs": [],
      "source": [
        "import os\n",
        "import random\n",
        "import glob\n",
        "import re\n",
        "\n",
        "import pandas as pd\n",
        "import numpy as np\n",
        "\n",
        "from sklearn.preprocessing import MinMaxScaler\n",
        "from sklearn.model_selection import train_test_split\n",
        "\n",
        "\n",
        "import torch\n",
        "import torch.nn as nn\n",
        "from tqdm import tqdm\n",
        "\n",
        "from catboost import CatBoostRegressor\n",
        "from sklearn.metrics import mean_squared_error\n",
        "\n",
        "import pandas as pd\n",
        "import holidays\n",
        "from tqdm import tqdm\n"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "RM0wZxe-wUnH"
      },
      "source": [
        "# Fixed RandomSeed & Setting Hyperparameter"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 6,
      "metadata": {
        "id": "51WOT4xswUnI"
      },
      "outputs": [],
      "source": [
        "def set_seed(seed=42):\n",
        "    random.seed(seed)\n",
        "    np.random.seed(seed)\n",
        "    torch.manual_seed(seed)\n",
        "    os.environ['PYTHONHASHSEED'] = str(seed)\n",
        "\n",
        "    if torch.cuda.is_available():\n",
        "        torch.cuda.manual_seed(seed)\n",
        "        torch.cuda.manual_seed_all(seed)\n",
        "        torch.backends.cudnn.deterministic = True\n",
        "        torch.backends.cudnn.benchmark = False\n",
        "\n",
        "set_seed(42)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 7,
      "metadata": {
        "id": "uZHnA7K7wUnJ"
      },
      "outputs": [],
      "source": [
        "LOOKBACK, PREDICT, BATCH_SIZE, EPOCHS = 28, 7, 16, 50\n",
        "DEVICE = torch.device('cuda' if torch.cuda.is_available() else 'cpu')"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "geDPtVXTwUnK"
      },
      "source": [
        "# Data Load"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 8,
      "metadata": {
        "id": "aO4lYuBmwUnL"
      },
      "outputs": [],
      "source": [
        "train_data = pd.read_csv('/content/train.csv', encoding='utf-8-sig')"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "6aZgPP1Ot0wE"
      },
      "source": [
        "# Data 분석"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 9,
      "metadata": {
        "id": "MDnqSyB14H24"
      },
      "outputs": [],
      "source": [
        "train_data['매출수량'] = train_data['매출수량'].apply(lambda x: max(x, 0))"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 10,
      "metadata": {
        "id": "riwuM8mPLGxY"
      },
      "outputs": [],
      "source": [
        "train_data = train_data.sort_values(['영업장명_메뉴명', '영업일자'])\n",
        "train_data['영업일자'] = pd.to_datetime(train_data['영업일자'])"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 11,
      "metadata": {
        "id": "q-CZZsiKT6TO"
      },
      "outputs": [],
      "source": [
        "train_data['요일'] = train_data['영업일자'].dt.day_name()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 12,
      "metadata": {
        "id": "mDEelmDrT6WH"
      },
      "outputs": [],
      "source": [
        "train_data[['영업장명', '메뉴명']] = train_data['영업장명_메뉴명'].str.split('_', n=1, expand=True)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 13,
      "metadata": {
        "id": "qvB5zgHw9om2"
      },
      "outputs": [],
      "source": [
        "def make_expanded_train(df, input_window_size=28, predict_window_size=7):\n",
        "    df = df.sort_values(['영업장명_메뉴명', '영업일자'])\n",
        "    df['영업일자'] = pd.to_datetime(df['영업일자'])\n",
        "\n",
        "    result = []\n",
        "\n",
        "    for name, group in df.groupby('영업장명_메뉴명'):\n",
        "        group = group.sort_values('영업일자')\n",
        "        sales = group['매출수량'].values\n",
        "        dates = group['영업일자'].values\n",
        "        store_name = group['영업장명'].iloc[0]\n",
        "        menu_name = group['메뉴명'].iloc[0]\n",
        "\n",
        "        for i in range(len(group) - input_window_size - predict_window_size + 1):\n",
        "            input_window = sales[i : i + input_window_size]\n",
        "            predict_window = sales[i + input_window_size : i + input_window_size + predict_window_size]\n",
        "            start_date = dates[i]\n",
        "\n",
        "            for j in range(predict_window_size):\n",
        "                predict_date = dates[i + input_window_size + j]\n",
        "\n",
        "                result.append({\n",
        "                    '영업장명_메뉴명': name,\n",
        "                    'store_name': store_name,\n",
        "                    'menu_name': menu_name,\n",
        "                    'start_date': start_date,\n",
        "                    **{f'X_{k}': input_window[k] for k in range(input_window_size)},\n",
        "                    'predict_date': predict_date,\n",
        "                    'predict_date_offset': j + 1,\n",
        "                    'target': predict_window[j]\n",
        "                })\n",
        "\n",
        "    df_result = pd.DataFrame(result)\n",
        "\n",
        "    df_result.insert(df_result.columns.get_loc('start_date') + 1, 'start_date_year', df_result['start_date'].dt.year)\n",
        "    df_result.insert(df_result.columns.get_loc('start_date') + 2, 'start_date_month', df_result['start_date'].dt.month)\n",
        "    df_result.insert(df_result.columns.get_loc('start_date') + 3, 'start_date_day', df_result['start_date'].dt.day)\n",
        "    df_result.insert(df_result.columns.get_loc('start_date') + 4, 'start_date_weekday', df_result['start_date'].dt.day_name())\n",
        "    df_result.insert(df_result.columns.get_loc('start_date') + 5, 'start_date_holiday', df_result['start_date'].dt.date.isin(holidays.KR(years=[2023, 2024, 2025])).astype(int))\n",
        "    df_result.insert(df_result.columns.get_loc('start_date') + 6, 'start_date_quarter', df_result['start_date'].dt.quarter)\n",
        "\n",
        "    df_result.insert(df_result.columns.get_loc('predict_date') + 1, 'predict_date_year', df_result['predict_date'].dt.year)\n",
        "    df_result.insert(df_result.columns.get_loc('predict_date') + 2, 'predict_date_month', df_result['predict_date'].dt.month)\n",
        "    df_result.insert(df_result.columns.get_loc('predict_date') + 3, 'predict_date_day', df_result['predict_date'].dt.day)\n",
        "    df_result.insert(df_result.columns.get_loc('predict_date') + 4, 'predict_date_weekday', df_result['predict_date'].dt.day_name())\n",
        "    df_result.insert(df_result.columns.get_loc('predict_date') + 5, 'predict_date_holiday', df_result['predict_date'].dt.date.isin(holidays.KR(years=[2023, 2024, 2025])).astype(int))\n",
        "    df_result.insert(df_result.columns.get_loc('predict_date') + 6, 'predict_date_quarter', df_result['predict_date'].dt.quarter)\n",
        "\n",
        "    return df_result\n"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 15,
      "metadata": {
        "id": "mrjWu9kM9okO"
      },
      "outputs": [],
      "source": [
        "df_train = make_expanded_train(train_data.copy(), input_window_size=28, predict_window_size=7)"
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "df_train = df_train[df_train['target']!=0].copy()\n",
        "df_train.shape"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "bHEqfVxDoV8O",
        "outputId": "456ac58e-f129-47a0-e4df-930ed7e7a2d2"
      },
      "execution_count": 17,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "(319914, 47)"
            ]
          },
          "metadata": {},
          "execution_count": 17
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "df_train.columns"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "tDX61gt1sE1H",
        "outputId": "1616af09-0128-4222-d703-a161467b8787"
      },
      "execution_count": 22,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "Index(['영업장명_메뉴명', 'store_name', 'menu_name', 'start_date', 'start_date_year',\n",
              "       'start_date_month', 'start_date_day', 'start_date_weekday',\n",
              "       'start_date_holiday', 'start_date_quarter', 'X_0', 'X_1', 'X_2', 'X_3',\n",
              "       'X_4', 'X_5', 'X_6', 'X_7', 'X_8', 'X_9', 'X_10', 'X_11', 'X_12',\n",
              "       'X_13', 'X_14', 'X_15', 'X_16', 'X_17', 'X_18', 'X_19', 'X_20', 'X_21',\n",
              "       'X_22', 'X_23', 'X_24', 'X_25', 'X_26', 'X_27', 'predict_date',\n",
              "       'predict_date_year', 'predict_date_month', 'predict_date_day',\n",
              "       'predict_date_weekday', 'predict_date_holiday', 'predict_date_quarter',\n",
              "       'predict_date_offset', 'target'],\n",
              "      dtype='object')"
            ]
          },
          "metadata": {},
          "execution_count": 22
        }
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 29,
      "metadata": {
        "id": "jpmz0py1RP4r"
      },
      "outputs": [],
      "source": [
        "num_features = [col for col in df_train.columns if col.startswith(\"X_\")]\n",
        "del_features = [\"영업장명_메뉴명\", \"start_date\", \"start_date_year\", \"predict_date\", \"predict_date_year\"]\n",
        "cat_features = [col for col in df_train.columns if col not in num_features and col not in del_features and col != 'target']\n",
        "\n",
        "features = num_features + cat_features"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 30,
      "metadata": {
        "id": "a2y3aw7YSh0k"
      },
      "outputs": [],
      "source": [
        "x_train, x_val, y_train, y_val = train_test_split(\n",
        "    df_train[features],\n",
        "    df_train[\"target\"],\n",
        "    test_size=0.2,\n",
        "    shuffle=True,\n",
        ")"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 31,
      "metadata": {
        "collapsed": true,
        "id": "2cFIxaV4Opoz",
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "6f723d54-e879-41df-c488-79eeed7557a6"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Learning rate set to 0.121611\n",
            "0:\tlearn: 52.1775308\ttest: 51.7600294\tbest: 51.7600294 (0)\ttotal: 815ms\tremaining: 13m 34s\n",
            "1:\tlearn: 48.6886996\ttest: 48.4474542\tbest: 48.4474542 (1)\ttotal: 1.45s\tremaining: 12m 4s\n",
            "2:\tlearn: 45.7450899\ttest: 45.6767470\tbest: 45.6767470 (2)\ttotal: 1.94s\tremaining: 10m 44s\n",
            "3:\tlearn: 43.2036648\ttest: 43.2822110\tbest: 43.2822110 (3)\ttotal: 2.54s\tremaining: 10m 32s\n",
            "4:\tlearn: 41.0269506\ttest: 41.2567834\tbest: 41.2567834 (4)\ttotal: 3.14s\tremaining: 10m 24s\n",
            "5:\tlearn: 39.2221656\ttest: 39.6091627\tbest: 39.6091627 (5)\ttotal: 3.72s\tremaining: 10m 16s\n",
            "6:\tlearn: 37.7116480\ttest: 38.2192203\tbest: 38.2192203 (6)\ttotal: 4.29s\tremaining: 10m 8s\n",
            "7:\tlearn: 36.4077929\ttest: 37.0166696\tbest: 37.0166696 (7)\ttotal: 4.87s\tremaining: 10m 3s\n",
            "8:\tlearn: 35.1204656\ttest: 35.7630833\tbest: 35.7630833 (8)\ttotal: 5.41s\tremaining: 9m 55s\n",
            "9:\tlearn: 33.9751825\ttest: 34.7038699\tbest: 34.7038699 (9)\ttotal: 5.93s\tremaining: 9m 47s\n",
            "10:\tlearn: 33.0508736\ttest: 33.8698926\tbest: 33.8698926 (10)\ttotal: 6.38s\tremaining: 9m 33s\n",
            "11:\tlearn: 32.2632955\ttest: 33.1076336\tbest: 33.1076336 (11)\ttotal: 6.77s\tremaining: 9m 17s\n",
            "12:\tlearn: 31.6003527\ttest: 32.5301310\tbest: 32.5301310 (12)\ttotal: 7.18s\tremaining: 9m 5s\n",
            "13:\tlearn: 31.0744051\ttest: 32.0595525\tbest: 32.0595525 (13)\ttotal: 7.66s\tremaining: 8m 59s\n",
            "14:\tlearn: 30.5512319\ttest: 31.5837446\tbest: 31.5837446 (14)\ttotal: 8.17s\tremaining: 8m 56s\n",
            "15:\tlearn: 30.1159754\ttest: 31.1536773\tbest: 31.1536773 (15)\ttotal: 8.51s\tremaining: 8m 43s\n",
            "16:\tlearn: 29.7585002\ttest: 30.8254106\tbest: 30.8254106 (16)\ttotal: 9.06s\tremaining: 8m 43s\n",
            "17:\tlearn: 29.4405212\ttest: 30.5335024\tbest: 30.5335024 (17)\ttotal: 9.64s\tremaining: 8m 45s\n",
            "18:\tlearn: 29.1394443\ttest: 30.3013595\tbest: 30.3013595 (18)\ttotal: 10.1s\tremaining: 8m 40s\n",
            "19:\tlearn: 28.8692088\ttest: 30.0579976\tbest: 30.0579976 (19)\ttotal: 10.7s\tremaining: 8m 43s\n",
            "20:\tlearn: 28.6514367\ttest: 29.8765454\tbest: 29.8765454 (20)\ttotal: 11.7s\tremaining: 9m 5s\n",
            "21:\tlearn: 28.4213224\ttest: 29.6681677\tbest: 29.6681677 (21)\ttotal: 12.6s\tremaining: 9m 18s\n",
            "22:\tlearn: 28.1133606\ttest: 29.4075145\tbest: 29.4075145 (22)\ttotal: 13.5s\tremaining: 9m 33s\n",
            "23:\tlearn: 27.8405461\ttest: 29.1623580\tbest: 29.1623580 (23)\ttotal: 14.5s\tremaining: 9m 47s\n",
            "24:\tlearn: 27.6850776\ttest: 29.0320655\tbest: 29.0320655 (24)\ttotal: 15.2s\tremaining: 9m 51s\n",
            "25:\tlearn: 27.4670370\ttest: 28.8311096\tbest: 28.8311096 (25)\ttotal: 15.8s\tremaining: 9m 51s\n",
            "26:\tlearn: 27.3155577\ttest: 28.6932486\tbest: 28.6932486 (26)\ttotal: 16.3s\tremaining: 9m 47s\n",
            "27:\tlearn: 27.2203473\ttest: 28.6182215\tbest: 28.6182215 (27)\ttotal: 16.8s\tremaining: 9m 43s\n",
            "28:\tlearn: 27.0308486\ttest: 28.4083111\tbest: 28.4083111 (28)\ttotal: 17.3s\tremaining: 9m 40s\n",
            "29:\tlearn: 26.9038242\ttest: 28.2936359\tbest: 28.2936359 (29)\ttotal: 17.9s\tremaining: 9m 39s\n",
            "30:\tlearn: 26.7428923\ttest: 28.1413313\tbest: 28.1413313 (30)\ttotal: 18.4s\tremaining: 9m 35s\n",
            "31:\tlearn: 26.6557201\ttest: 28.0688757\tbest: 28.0688757 (31)\ttotal: 18.9s\tremaining: 9m 32s\n",
            "32:\tlearn: 26.5232766\ttest: 27.9489949\tbest: 27.9489949 (32)\ttotal: 19.4s\tremaining: 9m 27s\n",
            "33:\tlearn: 26.4257188\ttest: 27.8565923\tbest: 27.8565923 (33)\ttotal: 19.9s\tremaining: 9m 26s\n",
            "34:\tlearn: 26.3395897\ttest: 27.7756462\tbest: 27.7756462 (34)\ttotal: 20.5s\tremaining: 9m 24s\n",
            "35:\tlearn: 26.2241821\ttest: 27.6424591\tbest: 27.6424591 (35)\ttotal: 21.1s\tremaining: 9m 24s\n",
            "36:\tlearn: 26.0329724\ttest: 27.4380305\tbest: 27.4380305 (36)\ttotal: 21.6s\tremaining: 9m 23s\n",
            "37:\tlearn: 25.9455437\ttest: 27.3813375\tbest: 27.3813375 (37)\ttotal: 22.2s\tremaining: 9m 22s\n",
            "38:\tlearn: 25.8587916\ttest: 27.3130054\tbest: 27.3130054 (38)\ttotal: 22.8s\tremaining: 9m 21s\n",
            "39:\tlearn: 25.7371625\ttest: 27.1556636\tbest: 27.1556636 (39)\ttotal: 23.3s\tremaining: 9m 19s\n",
            "40:\tlearn: 25.6701723\ttest: 27.1028225\tbest: 27.1028225 (40)\ttotal: 23.9s\tremaining: 9m 19s\n",
            "41:\tlearn: 25.5522006\ttest: 26.9584149\tbest: 26.9584149 (41)\ttotal: 24.4s\tremaining: 9m 17s\n",
            "42:\tlearn: 25.4812407\ttest: 26.8937069\tbest: 26.8937069 (42)\ttotal: 25s\tremaining: 9m 16s\n",
            "43:\tlearn: 25.4299948\ttest: 26.8404658\tbest: 26.8404658 (43)\ttotal: 26s\tremaining: 9m 24s\n",
            "44:\tlearn: 25.3658846\ttest: 26.7944026\tbest: 26.7944026 (44)\ttotal: 26.8s\tremaining: 9m 29s\n",
            "45:\tlearn: 25.3198982\ttest: 26.7674241\tbest: 26.7674241 (45)\ttotal: 27.7s\tremaining: 9m 34s\n",
            "46:\tlearn: 25.2756229\ttest: 26.7343232\tbest: 26.7343232 (46)\ttotal: 28.6s\tremaining: 9m 39s\n",
            "47:\tlearn: 25.2359708\ttest: 26.7058997\tbest: 26.7058997 (47)\ttotal: 29.4s\tremaining: 9m 43s\n",
            "48:\tlearn: 25.1349716\ttest: 26.5969214\tbest: 26.5969214 (48)\ttotal: 30s\tremaining: 9m 41s\n",
            "49:\tlearn: 25.0902531\ttest: 26.5469422\tbest: 26.5469422 (49)\ttotal: 30.5s\tremaining: 9m 39s\n",
            "50:\tlearn: 25.0291499\ttest: 26.4920118\tbest: 26.4920118 (50)\ttotal: 31.1s\tremaining: 9m 38s\n",
            "51:\tlearn: 24.8890870\ttest: 26.2921772\tbest: 26.2921772 (51)\ttotal: 31.7s\tremaining: 9m 37s\n",
            "52:\tlearn: 24.8556252\ttest: 26.2522447\tbest: 26.2522447 (52)\ttotal: 32.2s\tremaining: 9m 36s\n",
            "53:\tlearn: 24.8042074\ttest: 26.2064946\tbest: 26.2064946 (53)\ttotal: 32.7s\tremaining: 9m 33s\n",
            "54:\tlearn: 24.7696333\ttest: 26.1784784\tbest: 26.1784784 (54)\ttotal: 33.3s\tremaining: 9m 32s\n",
            "55:\tlearn: 24.7396151\ttest: 26.1574306\tbest: 26.1574306 (55)\ttotal: 33.9s\tremaining: 9m 31s\n",
            "56:\tlearn: 24.6899521\ttest: 26.1153726\tbest: 26.1153726 (56)\ttotal: 34.5s\tremaining: 9m 30s\n",
            "57:\tlearn: 24.6188405\ttest: 26.0347525\tbest: 26.0347525 (57)\ttotal: 35s\tremaining: 9m 29s\n",
            "58:\tlearn: 24.4753127\ttest: 25.8653456\tbest: 25.8653456 (58)\ttotal: 35.7s\tremaining: 9m 28s\n",
            "59:\tlearn: 24.4421122\ttest: 25.8509321\tbest: 25.8509321 (59)\ttotal: 36.3s\tremaining: 9m 28s\n",
            "60:\tlearn: 24.3849176\ttest: 25.7995828\tbest: 25.7995828 (60)\ttotal: 36.8s\tremaining: 9m 26s\n",
            "61:\tlearn: 24.3244939\ttest: 25.7033165\tbest: 25.7033165 (61)\ttotal: 37.3s\tremaining: 9m 23s\n",
            "62:\tlearn: 24.2768058\ttest: 25.6527261\tbest: 25.6527261 (62)\ttotal: 37.8s\tremaining: 9m 21s\n",
            "63:\tlearn: 24.2386000\ttest: 25.6121551\tbest: 25.6121551 (63)\ttotal: 38.3s\tremaining: 9m 20s\n",
            "64:\tlearn: 24.1995501\ttest: 25.5625349\tbest: 25.5625349 (64)\ttotal: 38.9s\tremaining: 9m 18s\n",
            "65:\tlearn: 24.1490625\ttest: 25.5149164\tbest: 25.5149164 (65)\ttotal: 39.3s\tremaining: 9m 16s\n",
            "66:\tlearn: 24.0270275\ttest: 25.3842046\tbest: 25.3842046 (66)\ttotal: 40.4s\tremaining: 9m 21s\n",
            "67:\tlearn: 23.9144035\ttest: 25.2901589\tbest: 25.2901589 (67)\ttotal: 41.2s\tremaining: 9m 24s\n",
            "68:\tlearn: 23.8773748\ttest: 25.2522205\tbest: 25.2522205 (68)\ttotal: 42.1s\tremaining: 9m 27s\n",
            "69:\tlearn: 23.8376857\ttest: 25.1993098\tbest: 25.1993098 (69)\ttotal: 43s\tremaining: 9m 30s\n",
            "70:\tlearn: 23.7811777\ttest: 25.1450427\tbest: 25.1450427 (70)\ttotal: 43.9s\tremaining: 9m 35s\n",
            "71:\tlearn: 23.7238425\ttest: 25.0816820\tbest: 25.0816820 (71)\ttotal: 44.6s\tremaining: 9m 34s\n",
            "72:\tlearn: 23.6877987\ttest: 25.0365616\tbest: 25.0365616 (72)\ttotal: 45.1s\tremaining: 9m 32s\n",
            "73:\tlearn: 23.6175591\ttest: 24.9193827\tbest: 24.9193827 (73)\ttotal: 45.6s\tremaining: 9m 31s\n",
            "74:\tlearn: 23.5541837\ttest: 24.8470664\tbest: 24.8470664 (74)\ttotal: 46.2s\tremaining: 9m 29s\n",
            "75:\tlearn: 23.5029948\ttest: 24.8008616\tbest: 24.8008616 (75)\ttotal: 46.7s\tremaining: 9m 27s\n",
            "76:\tlearn: 23.4708978\ttest: 24.7660882\tbest: 24.7660882 (76)\ttotal: 47.2s\tremaining: 9m 26s\n",
            "77:\tlearn: 23.4274643\ttest: 24.7096406\tbest: 24.7096406 (77)\ttotal: 47.8s\tremaining: 9m 25s\n",
            "78:\tlearn: 23.3856920\ttest: 24.6753603\tbest: 24.6753603 (78)\ttotal: 48.4s\tremaining: 9m 24s\n",
            "79:\tlearn: 23.3440599\ttest: 24.6309566\tbest: 24.6309566 (79)\ttotal: 48.9s\tremaining: 9m 22s\n",
            "80:\tlearn: 23.2971168\ttest: 24.5841949\tbest: 24.5841949 (80)\ttotal: 49.5s\tremaining: 9m 21s\n",
            "81:\tlearn: 23.2382288\ttest: 24.5327162\tbest: 24.5327162 (81)\ttotal: 50s\tremaining: 9m 19s\n",
            "82:\tlearn: 23.2028121\ttest: 24.4959695\tbest: 24.4959695 (82)\ttotal: 50.6s\tremaining: 9m 19s\n",
            "83:\tlearn: 23.1640001\ttest: 24.4573446\tbest: 24.4573446 (83)\ttotal: 51.2s\tremaining: 9m 18s\n",
            "84:\tlearn: 23.1103203\ttest: 24.4162190\tbest: 24.4162190 (84)\ttotal: 51.8s\tremaining: 9m 17s\n",
            "85:\tlearn: 23.0721469\ttest: 24.3918198\tbest: 24.3918198 (85)\ttotal: 52.3s\tremaining: 9m 15s\n",
            "86:\tlearn: 23.0305192\ttest: 24.3558620\tbest: 24.3558620 (86)\ttotal: 52.9s\tremaining: 9m 14s\n",
            "87:\tlearn: 22.9962488\ttest: 24.3310536\tbest: 24.3310536 (87)\ttotal: 53.4s\tremaining: 9m 13s\n",
            "88:\tlearn: 22.9767132\ttest: 24.3200297\tbest: 24.3200297 (88)\ttotal: 54s\tremaining: 9m 12s\n",
            "89:\tlearn: 22.9449079\ttest: 24.3016645\tbest: 24.3016645 (89)\ttotal: 54.9s\tremaining: 9m 15s\n",
            "90:\tlearn: 22.8984519\ttest: 24.2486262\tbest: 24.2486262 (90)\ttotal: 56s\tremaining: 9m 19s\n",
            "91:\tlearn: 22.8735974\ttest: 24.2297175\tbest: 24.2297175 (91)\ttotal: 57.1s\tremaining: 9m 23s\n",
            "92:\tlearn: 22.8360876\ttest: 24.2045386\tbest: 24.2045386 (92)\ttotal: 57.9s\tremaining: 9m 24s\n",
            "93:\tlearn: 22.8003425\ttest: 24.1682035\tbest: 24.1682035 (93)\ttotal: 58.6s\tremaining: 9m 24s\n",
            "94:\tlearn: 22.7645297\ttest: 24.1444317\tbest: 24.1444317 (94)\ttotal: 59.1s\tremaining: 9m 23s\n",
            "95:\tlearn: 22.7342208\ttest: 24.1127127\tbest: 24.1127127 (95)\ttotal: 59.7s\tremaining: 9m 22s\n",
            "96:\tlearn: 22.6696103\ttest: 24.0403653\tbest: 24.0403653 (96)\ttotal: 1m\tremaining: 9m 20s\n",
            "97:\tlearn: 22.6247324\ttest: 23.9915171\tbest: 23.9915171 (97)\ttotal: 1m\tremaining: 9m 19s\n",
            "98:\tlearn: 22.6013342\ttest: 23.9785652\tbest: 23.9785652 (98)\ttotal: 1m 1s\tremaining: 9m 19s\n",
            "99:\tlearn: 22.5714940\ttest: 23.9608543\tbest: 23.9608543 (99)\ttotal: 1m 1s\tremaining: 9m 17s\n",
            "100:\tlearn: 22.5440647\ttest: 23.9354117\tbest: 23.9354117 (100)\ttotal: 1m 2s\tremaining: 9m 17s\n",
            "101:\tlearn: 22.5196364\ttest: 23.9210980\tbest: 23.9210980 (101)\ttotal: 1m 3s\tremaining: 9m 15s\n",
            "102:\tlearn: 22.4898562\ttest: 23.8903772\tbest: 23.8903772 (102)\ttotal: 1m 3s\tremaining: 9m 14s\n",
            "103:\tlearn: 22.4590803\ttest: 23.8664422\tbest: 23.8664422 (103)\ttotal: 1m 4s\tremaining: 9m 13s\n",
            "104:\tlearn: 22.4324986\ttest: 23.8356712\tbest: 23.8356712 (104)\ttotal: 1m 4s\tremaining: 9m 12s\n",
            "105:\tlearn: 22.4074231\ttest: 23.8185038\tbest: 23.8185038 (105)\ttotal: 1m 5s\tremaining: 9m 11s\n",
            "106:\tlearn: 22.3622565\ttest: 23.7589695\tbest: 23.7589695 (106)\ttotal: 1m 5s\tremaining: 9m 9s\n",
            "107:\tlearn: 22.3333359\ttest: 23.7349751\tbest: 23.7349751 (107)\ttotal: 1m 6s\tremaining: 9m 8s\n",
            "108:\tlearn: 22.2967093\ttest: 23.6900920\tbest: 23.6900920 (108)\ttotal: 1m 6s\tremaining: 9m 7s\n",
            "109:\tlearn: 22.2604102\ttest: 23.6590876\tbest: 23.6590876 (109)\ttotal: 1m 7s\tremaining: 9m 6s\n",
            "110:\tlearn: 22.2352390\ttest: 23.6276763\tbest: 23.6276763 (110)\ttotal: 1m 8s\tremaining: 9m 5s\n",
            "111:\tlearn: 22.1979523\ttest: 23.6081855\tbest: 23.6081855 (111)\ttotal: 1m 8s\tremaining: 9m 6s\n",
            "112:\tlearn: 22.1754694\ttest: 23.5964269\tbest: 23.5964269 (112)\ttotal: 1m 9s\tremaining: 9m 9s\n",
            "113:\tlearn: 22.1467051\ttest: 23.5793735\tbest: 23.5793735 (113)\ttotal: 1m 10s\tremaining: 9m 11s\n",
            "114:\tlearn: 22.1139251\ttest: 23.5418722\tbest: 23.5418722 (114)\ttotal: 1m 11s\tremaining: 9m 12s\n",
            "115:\tlearn: 22.0845115\ttest: 23.5221479\tbest: 23.5221479 (115)\ttotal: 1m 12s\tremaining: 9m 14s\n",
            "116:\tlearn: 22.0522544\ttest: 23.4899260\tbest: 23.4899260 (116)\ttotal: 1m 13s\tremaining: 9m 12s\n",
            "117:\tlearn: 22.0316065\ttest: 23.4715400\tbest: 23.4715400 (117)\ttotal: 1m 13s\tremaining: 9m 11s\n",
            "118:\tlearn: 22.0145069\ttest: 23.4638266\tbest: 23.4638266 (118)\ttotal: 1m 14s\tremaining: 9m 10s\n",
            "119:\tlearn: 21.9826098\ttest: 23.4464408\tbest: 23.4464408 (119)\ttotal: 1m 14s\tremaining: 9m 9s\n",
            "120:\tlearn: 21.9643429\ttest: 23.4326491\tbest: 23.4326491 (120)\ttotal: 1m 15s\tremaining: 9m 8s\n",
            "121:\tlearn: 21.9430065\ttest: 23.4210678\tbest: 23.4210678 (121)\ttotal: 1m 16s\tremaining: 9m 7s\n",
            "122:\tlearn: 21.9219524\ttest: 23.4105739\tbest: 23.4105739 (122)\ttotal: 1m 16s\tremaining: 9m 6s\n",
            "123:\tlearn: 21.9055665\ttest: 23.4027032\tbest: 23.4027032 (123)\ttotal: 1m 17s\tremaining: 9m 5s\n",
            "124:\tlearn: 21.8857919\ttest: 23.3849920\tbest: 23.3849920 (124)\ttotal: 1m 17s\tremaining: 9m 4s\n",
            "125:\tlearn: 21.8609450\ttest: 23.3581910\tbest: 23.3581910 (125)\ttotal: 1m 18s\tremaining: 9m 4s\n",
            "126:\tlearn: 21.8439109\ttest: 23.3462940\tbest: 23.3462940 (126)\ttotal: 1m 18s\tremaining: 9m 2s\n",
            "127:\tlearn: 21.7958714\ttest: 23.3013265\tbest: 23.3013265 (127)\ttotal: 1m 19s\tremaining: 9m 1s\n",
            "128:\tlearn: 21.7728057\ttest: 23.2853384\tbest: 23.2853384 (128)\ttotal: 1m 20s\tremaining: 9m\n",
            "129:\tlearn: 21.7615306\ttest: 23.2802361\tbest: 23.2802361 (129)\ttotal: 1m 20s\tremaining: 8m 59s\n",
            "130:\tlearn: 21.7462657\ttest: 23.2697212\tbest: 23.2697212 (130)\ttotal: 1m 21s\tremaining: 8m 58s\n",
            "131:\tlearn: 21.6938439\ttest: 23.1700763\tbest: 23.1700763 (131)\ttotal: 1m 21s\tremaining: 8m 57s\n",
            "132:\tlearn: 21.6686270\ttest: 23.1374610\tbest: 23.1374610 (132)\ttotal: 1m 22s\tremaining: 8m 57s\n",
            "133:\tlearn: 21.6467072\ttest: 23.1266937\tbest: 23.1266937 (133)\ttotal: 1m 23s\tremaining: 8m 56s\n",
            "134:\tlearn: 21.6332865\ttest: 23.1227531\tbest: 23.1227531 (134)\ttotal: 1m 23s\tremaining: 8m 57s\n",
            "135:\tlearn: 21.6190530\ttest: 23.1088769\tbest: 23.1088769 (135)\ttotal: 1m 24s\tremaining: 8m 59s\n",
            "136:\tlearn: 21.5544057\ttest: 22.9971886\tbest: 22.9971886 (136)\ttotal: 1m 25s\tremaining: 9m 1s\n",
            "137:\tlearn: 21.5322080\ttest: 22.9739832\tbest: 22.9739832 (137)\ttotal: 1m 26s\tremaining: 9m 1s\n",
            "138:\tlearn: 21.5183291\ttest: 22.9606916\tbest: 22.9606916 (138)\ttotal: 1m 27s\tremaining: 9m 1s\n",
            "139:\tlearn: 21.4956290\ttest: 22.9424662\tbest: 22.9424662 (139)\ttotal: 1m 28s\tremaining: 9m\n",
            "140:\tlearn: 21.4869333\ttest: 22.9425281\tbest: 22.9424662 (139)\ttotal: 1m 28s\tremaining: 8m 59s\n",
            "141:\tlearn: 21.4679421\ttest: 22.9262814\tbest: 22.9262814 (141)\ttotal: 1m 29s\tremaining: 8m 58s\n",
            "142:\tlearn: 21.4305140\ttest: 22.8822803\tbest: 22.8822803 (142)\ttotal: 1m 29s\tremaining: 8m 57s\n",
            "143:\tlearn: 21.4085490\ttest: 22.8635458\tbest: 22.8635458 (143)\ttotal: 1m 30s\tremaining: 8m 56s\n",
            "144:\tlearn: 21.3882659\ttest: 22.8533042\tbest: 22.8533042 (144)\ttotal: 1m 30s\tremaining: 8m 55s\n",
            "145:\tlearn: 21.3478277\ttest: 22.7991555\tbest: 22.7991555 (145)\ttotal: 1m 31s\tremaining: 8m 55s\n",
            "146:\tlearn: 21.3325532\ttest: 22.7872548\tbest: 22.7872548 (146)\ttotal: 1m 32s\tremaining: 8m 54s\n",
            "147:\tlearn: 21.3241383\ttest: 22.7814990\tbest: 22.7814990 (147)\ttotal: 1m 32s\tremaining: 8m 53s\n",
            "148:\tlearn: 21.3027972\ttest: 22.7649345\tbest: 22.7649345 (148)\ttotal: 1m 33s\tremaining: 8m 52s\n",
            "149:\tlearn: 21.2720572\ttest: 22.7485149\tbest: 22.7485149 (149)\ttotal: 1m 33s\tremaining: 8m 51s\n",
            "150:\tlearn: 21.2526463\ttest: 22.7420033\tbest: 22.7420033 (150)\ttotal: 1m 34s\tremaining: 8m 50s\n",
            "151:\tlearn: 21.1955997\ttest: 22.6393613\tbest: 22.6393613 (151)\ttotal: 1m 34s\tremaining: 8m 49s\n",
            "152:\tlearn: 21.1761437\ttest: 22.6312346\tbest: 22.6312346 (152)\ttotal: 1m 35s\tremaining: 8m 48s\n",
            "153:\tlearn: 21.1608958\ttest: 22.6224203\tbest: 22.6224203 (153)\ttotal: 1m 36s\tremaining: 8m 47s\n",
            "154:\tlearn: 21.1405416\ttest: 22.5978481\tbest: 22.5978481 (154)\ttotal: 1m 36s\tremaining: 8m 46s\n",
            "155:\tlearn: 21.1179445\ttest: 22.5723920\tbest: 22.5723920 (155)\ttotal: 1m 37s\tremaining: 8m 45s\n",
            "156:\tlearn: 21.0837044\ttest: 22.5366258\tbest: 22.5366258 (156)\ttotal: 1m 37s\tremaining: 8m 45s\n",
            "157:\tlearn: 21.0720236\ttest: 22.5292301\tbest: 22.5292301 (157)\ttotal: 1m 38s\tremaining: 8m 46s\n",
            "158:\tlearn: 21.0630364\ttest: 22.5203073\tbest: 22.5203073 (158)\ttotal: 1m 39s\tremaining: 8m 47s\n",
            "159:\tlearn: 21.0377607\ttest: 22.4896552\tbest: 22.4896552 (159)\ttotal: 1m 40s\tremaining: 8m 48s\n",
            "160:\tlearn: 21.0248357\ttest: 22.4833860\tbest: 22.4833860 (160)\ttotal: 1m 41s\tremaining: 8m 49s\n",
            "161:\tlearn: 21.0138536\ttest: 22.4763206\tbest: 22.4763206 (161)\ttotal: 1m 42s\tremaining: 8m 48s\n",
            "162:\tlearn: 20.9862447\ttest: 22.4522231\tbest: 22.4522231 (162)\ttotal: 1m 42s\tremaining: 8m 47s\n",
            "163:\tlearn: 20.9645280\ttest: 22.4375009\tbest: 22.4375009 (163)\ttotal: 1m 43s\tremaining: 8m 46s\n",
            "164:\tlearn: 20.9237594\ttest: 22.3695500\tbest: 22.3695500 (164)\ttotal: 1m 43s\tremaining: 8m 45s\n",
            "165:\tlearn: 20.9010662\ttest: 22.3428094\tbest: 22.3428094 (165)\ttotal: 1m 44s\tremaining: 8m 44s\n",
            "166:\tlearn: 20.8853578\ttest: 22.3280975\tbest: 22.3280975 (166)\ttotal: 1m 44s\tremaining: 8m 43s\n",
            "167:\tlearn: 20.8514968\ttest: 22.2870507\tbest: 22.2870507 (167)\ttotal: 1m 45s\tremaining: 8m 42s\n",
            "168:\tlearn: 20.8330294\ttest: 22.2762466\tbest: 22.2762466 (168)\ttotal: 1m 46s\tremaining: 8m 41s\n",
            "169:\tlearn: 20.8172474\ttest: 22.2654923\tbest: 22.2654923 (169)\ttotal: 1m 46s\tremaining: 8m 40s\n",
            "170:\tlearn: 20.7724287\ttest: 22.2064686\tbest: 22.2064686 (170)\ttotal: 1m 47s\tremaining: 8m 39s\n",
            "171:\tlearn: 20.7476649\ttest: 22.1813599\tbest: 22.1813599 (171)\ttotal: 1m 47s\tremaining: 8m 38s\n",
            "172:\tlearn: 20.7017833\ttest: 22.1412842\tbest: 22.1412842 (172)\ttotal: 1m 48s\tremaining: 8m 37s\n",
            "173:\tlearn: 20.6888869\ttest: 22.1332235\tbest: 22.1332235 (173)\ttotal: 1m 48s\tremaining: 8m 36s\n",
            "174:\tlearn: 20.6718768\ttest: 22.1213505\tbest: 22.1213505 (174)\ttotal: 1m 49s\tremaining: 8m 35s\n",
            "175:\tlearn: 20.6643599\ttest: 22.1145348\tbest: 22.1145348 (175)\ttotal: 1m 49s\tremaining: 8m 33s\n",
            "176:\tlearn: 20.6441894\ttest: 22.0996377\tbest: 22.0996377 (176)\ttotal: 1m 50s\tremaining: 8m 33s\n",
            "177:\tlearn: 20.6202400\ttest: 22.0785570\tbest: 22.0785570 (177)\ttotal: 1m 50s\tremaining: 8m 32s\n",
            "178:\tlearn: 20.5659575\ttest: 22.0464122\tbest: 22.0464122 (178)\ttotal: 1m 51s\tremaining: 8m 31s\n",
            "179:\tlearn: 20.5413138\ttest: 22.0280921\tbest: 22.0280921 (179)\ttotal: 1m 52s\tremaining: 8m 31s\n",
            "180:\tlearn: 20.5142823\ttest: 22.0148078\tbest: 22.0148078 (180)\ttotal: 1m 53s\tremaining: 8m 31s\n",
            "181:\tlearn: 20.4937879\ttest: 21.9986306\tbest: 21.9986306 (181)\ttotal: 1m 53s\tremaining: 8m 32s\n",
            "182:\tlearn: 20.4774495\ttest: 21.9880634\tbest: 21.9880634 (182)\ttotal: 1m 54s\tremaining: 8m 33s\n",
            "183:\tlearn: 20.4634884\ttest: 21.9857803\tbest: 21.9857803 (183)\ttotal: 1m 55s\tremaining: 8m 33s\n",
            "184:\tlearn: 20.4475718\ttest: 21.9719451\tbest: 21.9719451 (184)\ttotal: 1m 56s\tremaining: 8m 33s\n",
            "185:\tlearn: 20.4252381\ttest: 21.9489672\tbest: 21.9489672 (185)\ttotal: 1m 57s\tremaining: 8m 32s\n",
            "186:\tlearn: 20.4063011\ttest: 21.9343845\tbest: 21.9343845 (186)\ttotal: 1m 57s\tremaining: 8m 31s\n",
            "187:\tlearn: 20.3916806\ttest: 21.9225055\tbest: 21.9225055 (187)\ttotal: 1m 58s\tremaining: 8m 30s\n",
            "188:\tlearn: 20.3737658\ttest: 21.9106172\tbest: 21.9106172 (188)\ttotal: 1m 58s\tremaining: 8m 29s\n",
            "189:\tlearn: 20.3251733\ttest: 21.8614516\tbest: 21.8614516 (189)\ttotal: 1m 59s\tremaining: 8m 29s\n",
            "190:\tlearn: 20.3173996\ttest: 21.8564812\tbest: 21.8564812 (190)\ttotal: 2m\tremaining: 8m 28s\n",
            "191:\tlearn: 20.2976447\ttest: 21.8393170\tbest: 21.8393170 (191)\ttotal: 2m\tremaining: 8m 27s\n",
            "192:\tlearn: 20.2786380\ttest: 21.8199905\tbest: 21.8199905 (192)\ttotal: 2m 1s\tremaining: 8m 26s\n",
            "193:\tlearn: 20.2520300\ttest: 21.7697504\tbest: 21.7697504 (193)\ttotal: 2m 1s\tremaining: 8m 24s\n",
            "194:\tlearn: 20.2438404\ttest: 21.7678018\tbest: 21.7678018 (194)\ttotal: 2m 2s\tremaining: 8m 23s\n",
            "195:\tlearn: 20.2283691\ttest: 21.7551343\tbest: 21.7551343 (195)\ttotal: 2m 2s\tremaining: 8m 22s\n",
            "196:\tlearn: 20.2164537\ttest: 21.7496135\tbest: 21.7496135 (196)\ttotal: 2m 3s\tremaining: 8m 22s\n",
            "197:\tlearn: 20.2055889\ttest: 21.7340446\tbest: 21.7340446 (197)\ttotal: 2m 3s\tremaining: 8m 21s\n",
            "198:\tlearn: 20.1904336\ttest: 21.7248112\tbest: 21.7248112 (198)\ttotal: 2m 4s\tremaining: 8m 20s\n",
            "199:\tlearn: 20.1786485\ttest: 21.7122259\tbest: 21.7122259 (199)\ttotal: 2m 5s\tremaining: 8m 20s\n",
            "200:\tlearn: 20.1677373\ttest: 21.7047691\tbest: 21.7047691 (200)\ttotal: 2m 5s\tremaining: 8m 19s\n",
            "201:\tlearn: 20.1539047\ttest: 21.6955440\tbest: 21.6955440 (201)\ttotal: 2m 6s\tremaining: 8m 18s\n",
            "202:\tlearn: 20.1373532\ttest: 21.6785743\tbest: 21.6785743 (202)\ttotal: 2m 7s\tremaining: 8m 18s\n",
            "203:\tlearn: 20.1173122\ttest: 21.6653925\tbest: 21.6653925 (203)\ttotal: 2m 8s\tremaining: 8m 19s\n",
            "204:\tlearn: 20.1136203\ttest: 21.6636349\tbest: 21.6636349 (204)\ttotal: 2m 8s\tremaining: 8m 20s\n",
            "205:\tlearn: 20.0758518\ttest: 21.6219277\tbest: 21.6219277 (205)\ttotal: 2m 10s\tremaining: 8m 22s\n",
            "206:\tlearn: 20.0480048\ttest: 21.5967981\tbest: 21.5967981 (206)\ttotal: 2m 10s\tremaining: 8m 21s\n",
            "207:\tlearn: 20.0298177\ttest: 21.5739337\tbest: 21.5739337 (207)\ttotal: 2m 11s\tremaining: 8m 20s\n",
            "208:\tlearn: 20.0090810\ttest: 21.5493677\tbest: 21.5493677 (208)\ttotal: 2m 12s\tremaining: 8m 19s\n",
            "209:\tlearn: 19.9858197\ttest: 21.5333628\tbest: 21.5333628 (209)\ttotal: 2m 12s\tremaining: 8m 18s\n",
            "210:\tlearn: 19.9675864\ttest: 21.5256948\tbest: 21.5256948 (210)\ttotal: 2m 13s\tremaining: 8m 17s\n",
            "211:\tlearn: 19.9383833\ttest: 21.4988724\tbest: 21.4988724 (211)\ttotal: 2m 13s\tremaining: 8m 17s\n",
            "212:\tlearn: 19.9142498\ttest: 21.4714247\tbest: 21.4714247 (212)\ttotal: 2m 14s\tremaining: 8m 16s\n",
            "213:\tlearn: 19.8758150\ttest: 21.4405701\tbest: 21.4405701 (213)\ttotal: 2m 14s\tremaining: 8m 15s\n",
            "214:\tlearn: 19.8571717\ttest: 21.4265848\tbest: 21.4265848 (214)\ttotal: 2m 15s\tremaining: 8m 14s\n",
            "215:\tlearn: 19.8448876\ttest: 21.4192334\tbest: 21.4192334 (215)\ttotal: 2m 16s\tremaining: 8m 13s\n",
            "216:\tlearn: 19.8258576\ttest: 21.4006780\tbest: 21.4006780 (216)\ttotal: 2m 16s\tremaining: 8m 13s\n",
            "217:\tlearn: 19.8122782\ttest: 21.3900203\tbest: 21.3900203 (217)\ttotal: 2m 17s\tremaining: 8m 12s\n",
            "218:\tlearn: 19.7935808\ttest: 21.3775279\tbest: 21.3775279 (218)\ttotal: 2m 17s\tremaining: 8m 10s\n",
            "219:\tlearn: 19.7717191\ttest: 21.3624733\tbest: 21.3624733 (219)\ttotal: 2m 18s\tremaining: 8m 10s\n",
            "220:\tlearn: 19.7586018\ttest: 21.3569620\tbest: 21.3569620 (220)\ttotal: 2m 18s\tremaining: 8m 9s\n",
            "221:\tlearn: 19.7468646\ttest: 21.3539298\tbest: 21.3539298 (221)\ttotal: 2m 19s\tremaining: 8m 8s\n",
            "222:\tlearn: 19.7244991\ttest: 21.3380144\tbest: 21.3380144 (222)\ttotal: 2m 19s\tremaining: 8m 7s\n",
            "223:\tlearn: 19.7186219\ttest: 21.3340014\tbest: 21.3340014 (223)\ttotal: 2m 20s\tremaining: 8m 6s\n",
            "224:\tlearn: 19.7059568\ttest: 21.3221484\tbest: 21.3221484 (224)\ttotal: 2m 21s\tremaining: 8m 7s\n",
            "225:\tlearn: 19.6823400\ttest: 21.3024779\tbest: 21.3024779 (225)\ttotal: 2m 22s\tremaining: 8m 7s\n",
            "226:\tlearn: 19.6787739\ttest: 21.3026485\tbest: 21.3024779 (225)\ttotal: 2m 23s\tremaining: 8m 8s\n",
            "227:\tlearn: 19.6728636\ttest: 21.3011329\tbest: 21.3011329 (227)\ttotal: 2m 24s\tremaining: 8m 8s\n",
            "228:\tlearn: 19.6677219\ttest: 21.2989633\tbest: 21.2989633 (228)\ttotal: 2m 25s\tremaining: 8m 8s\n",
            "229:\tlearn: 19.6595147\ttest: 21.2975265\tbest: 21.2975265 (229)\ttotal: 2m 25s\tremaining: 8m 7s\n",
            "230:\tlearn: 19.6515627\ttest: 21.2914022\tbest: 21.2914022 (230)\ttotal: 2m 26s\tremaining: 8m 7s\n",
            "231:\tlearn: 19.6161579\ttest: 21.2207976\tbest: 21.2207976 (231)\ttotal: 2m 26s\tremaining: 8m 5s\n",
            "232:\tlearn: 19.6013307\ttest: 21.2052201\tbest: 21.2052201 (232)\ttotal: 2m 27s\tremaining: 8m 4s\n",
            "233:\tlearn: 19.5939464\ttest: 21.1964603\tbest: 21.1964603 (233)\ttotal: 2m 27s\tremaining: 8m 4s\n",
            "234:\tlearn: 19.5701532\ttest: 21.1775824\tbest: 21.1775824 (234)\ttotal: 2m 28s\tremaining: 8m 3s\n",
            "235:\tlearn: 19.5458198\ttest: 21.1464953\tbest: 21.1464953 (235)\ttotal: 2m 29s\tremaining: 8m 2s\n",
            "236:\tlearn: 19.5295939\ttest: 21.1270253\tbest: 21.1270253 (236)\ttotal: 2m 29s\tremaining: 8m 2s\n",
            "237:\tlearn: 19.5210774\ttest: 21.1236662\tbest: 21.1236662 (237)\ttotal: 2m 30s\tremaining: 8m 1s\n",
            "238:\tlearn: 19.5066618\ttest: 21.1120914\tbest: 21.1120914 (238)\ttotal: 2m 30s\tremaining: 8m\n",
            "239:\tlearn: 19.4973105\ttest: 21.1097815\tbest: 21.1097815 (239)\ttotal: 2m 31s\tremaining: 7m 59s\n",
            "240:\tlearn: 19.4810878\ttest: 21.0920588\tbest: 21.0920588 (240)\ttotal: 2m 32s\tremaining: 7m 58s\n",
            "241:\tlearn: 19.4672783\ttest: 21.0859917\tbest: 21.0859917 (241)\ttotal: 2m 32s\tremaining: 7m 58s\n",
            "242:\tlearn: 19.4536823\ttest: 21.0683211\tbest: 21.0683211 (242)\ttotal: 2m 33s\tremaining: 7m 58s\n",
            "243:\tlearn: 19.4414949\ttest: 21.0651635\tbest: 21.0651635 (243)\ttotal: 2m 34s\tremaining: 7m 58s\n",
            "244:\tlearn: 19.4279756\ttest: 21.0539842\tbest: 21.0539842 (244)\ttotal: 2m 35s\tremaining: 7m 59s\n",
            "245:\tlearn: 19.4193667\ttest: 21.0474219\tbest: 21.0474219 (245)\ttotal: 2m 36s\tremaining: 8m\n",
            "246:\tlearn: 19.4019278\ttest: 21.0348533\tbest: 21.0348533 (246)\ttotal: 2m 37s\tremaining: 8m 1s\n",
            "247:\tlearn: 19.3829578\ttest: 21.0171619\tbest: 21.0171619 (247)\ttotal: 2m 39s\tremaining: 8m 2s\n",
            "248:\tlearn: 19.3645985\ttest: 20.9999699\tbest: 20.9999699 (248)\ttotal: 2m 40s\tremaining: 8m 3s\n",
            "249:\tlearn: 19.3498602\ttest: 20.9906475\tbest: 20.9906475 (249)\ttotal: 2m 41s\tremaining: 8m 3s\n",
            "250:\tlearn: 19.3358517\ttest: 20.9847059\tbest: 20.9847059 (250)\ttotal: 2m 41s\tremaining: 8m 2s\n",
            "251:\tlearn: 19.3229874\ttest: 20.9805981\tbest: 20.9805981 (251)\ttotal: 2m 42s\tremaining: 8m 1s\n",
            "252:\tlearn: 19.3060278\ttest: 20.9622015\tbest: 20.9622015 (252)\ttotal: 2m 42s\tremaining: 8m\n",
            "253:\tlearn: 19.3009241\ttest: 20.9548830\tbest: 20.9548830 (253)\ttotal: 2m 43s\tremaining: 8m\n",
            "254:\tlearn: 19.2895800\ttest: 20.9462674\tbest: 20.9462674 (254)\ttotal: 2m 44s\tremaining: 7m 59s\n",
            "255:\tlearn: 19.2802191\ttest: 20.9415686\tbest: 20.9415686 (255)\ttotal: 2m 44s\tremaining: 7m 58s\n",
            "256:\tlearn: 19.2721920\ttest: 20.9362101\tbest: 20.9362101 (256)\ttotal: 2m 45s\tremaining: 7m 57s\n",
            "257:\tlearn: 19.2491235\ttest: 20.9089779\tbest: 20.9089779 (257)\ttotal: 2m 45s\tremaining: 7m 56s\n",
            "258:\tlearn: 19.2278910\ttest: 20.8900606\tbest: 20.8900606 (258)\ttotal: 2m 46s\tremaining: 7m 55s\n",
            "259:\tlearn: 19.2234817\ttest: 20.8879280\tbest: 20.8879280 (259)\ttotal: 2m 46s\tremaining: 7m 55s\n",
            "260:\tlearn: 19.2078566\ttest: 20.8761910\tbest: 20.8761910 (260)\ttotal: 2m 47s\tremaining: 7m 53s\n",
            "261:\tlearn: 19.1976204\ttest: 20.8672883\tbest: 20.8672883 (261)\ttotal: 2m 47s\tremaining: 7m 53s\n",
            "262:\tlearn: 19.1829156\ttest: 20.8534446\tbest: 20.8534446 (262)\ttotal: 2m 48s\tremaining: 7m 52s\n",
            "263:\tlearn: 19.1793778\ttest: 20.8518916\tbest: 20.8518916 (263)\ttotal: 2m 49s\tremaining: 7m 51s\n",
            "264:\tlearn: 19.1743628\ttest: 20.8512124\tbest: 20.8512124 (264)\ttotal: 2m 49s\tremaining: 7m 50s\n",
            "265:\tlearn: 19.1720529\ttest: 20.8514933\tbest: 20.8512124 (264)\ttotal: 2m 50s\tremaining: 7m 49s\n",
            "266:\tlearn: 19.1638870\ttest: 20.8429058\tbest: 20.8429058 (266)\ttotal: 2m 50s\tremaining: 7m 49s\n",
            "267:\tlearn: 19.1592469\ttest: 20.8409924\tbest: 20.8409924 (267)\ttotal: 2m 51s\tremaining: 7m 48s\n",
            "268:\tlearn: 19.1558277\ttest: 20.8386444\tbest: 20.8386444 (268)\ttotal: 2m 52s\tremaining: 7m 48s\n",
            "269:\tlearn: 19.1462786\ttest: 20.8282682\tbest: 20.8282682 (269)\ttotal: 2m 53s\tremaining: 7m 48s\n",
            "270:\tlearn: 19.1200233\ttest: 20.7994753\tbest: 20.7994753 (270)\ttotal: 2m 54s\tremaining: 7m 49s\n",
            "271:\tlearn: 19.1003283\ttest: 20.7690740\tbest: 20.7690740 (271)\ttotal: 2m 55s\tremaining: 7m 49s\n",
            "272:\tlearn: 19.0864128\ttest: 20.7519967\tbest: 20.7519967 (272)\ttotal: 2m 55s\tremaining: 7m 48s\n",
            "273:\tlearn: 19.0735660\ttest: 20.7432849\tbest: 20.7432849 (273)\ttotal: 2m 56s\tremaining: 7m 47s\n",
            "274:\tlearn: 19.0680791\ttest: 20.7362480\tbest: 20.7362480 (274)\ttotal: 2m 56s\tremaining: 7m 46s\n",
            "275:\tlearn: 19.0553840\ttest: 20.7236017\tbest: 20.7236017 (275)\ttotal: 2m 57s\tremaining: 7m 45s\n",
            "276:\tlearn: 19.0474180\ttest: 20.7119138\tbest: 20.7119138 (276)\ttotal: 2m 58s\tremaining: 7m 45s\n",
            "277:\tlearn: 19.0335039\ttest: 20.7062591\tbest: 20.7062591 (277)\ttotal: 2m 58s\tremaining: 7m 43s\n",
            "278:\tlearn: 19.0181960\ttest: 20.6879156\tbest: 20.6879156 (278)\ttotal: 2m 59s\tremaining: 7m 42s\n",
            "279:\tlearn: 19.0110956\ttest: 20.6849864\tbest: 20.6849864 (279)\ttotal: 2m 59s\tremaining: 7m 41s\n",
            "280:\tlearn: 18.9973589\ttest: 20.6719258\tbest: 20.6719258 (280)\ttotal: 3m\tremaining: 7m 41s\n",
            "281:\tlearn: 18.9732644\ttest: 20.6185193\tbest: 20.6185193 (281)\ttotal: 3m\tremaining: 7m 40s\n",
            "282:\tlearn: 18.9601309\ttest: 20.6135937\tbest: 20.6135937 (282)\ttotal: 3m 1s\tremaining: 7m 39s\n",
            "283:\tlearn: 18.9398233\ttest: 20.6013191\tbest: 20.6013191 (283)\ttotal: 3m 1s\tremaining: 7m 38s\n",
            "284:\tlearn: 18.9375475\ttest: 20.6009474\tbest: 20.6009474 (284)\ttotal: 3m 2s\tremaining: 7m 37s\n",
            "285:\tlearn: 18.9357710\ttest: 20.6012089\tbest: 20.6009474 (284)\ttotal: 3m 2s\tremaining: 7m 36s\n",
            "286:\tlearn: 18.9275736\ttest: 20.5947867\tbest: 20.5947867 (286)\ttotal: 3m 3s\tremaining: 7m 35s\n",
            "287:\tlearn: 18.9202107\ttest: 20.5896580\tbest: 20.5896580 (287)\ttotal: 3m 4s\tremaining: 7m 34s\n",
            "288:\tlearn: 18.9108550\ttest: 20.5848196\tbest: 20.5848196 (288)\ttotal: 3m 4s\tremaining: 7m 34s\n",
            "289:\tlearn: 18.8917286\ttest: 20.5737457\tbest: 20.5737457 (289)\ttotal: 3m 5s\tremaining: 7m 33s\n",
            "290:\tlearn: 18.8794211\ttest: 20.5641495\tbest: 20.5641495 (290)\ttotal: 3m 5s\tremaining: 7m 32s\n",
            "291:\tlearn: 18.8526128\ttest: 20.5545350\tbest: 20.5545350 (291)\ttotal: 3m 6s\tremaining: 7m 32s\n",
            "292:\tlearn: 18.8509567\ttest: 20.5545723\tbest: 20.5545350 (291)\ttotal: 3m 7s\tremaining: 7m 32s\n",
            "293:\tlearn: 18.8401466\ttest: 20.5446662\tbest: 20.5446662 (293)\ttotal: 3m 8s\tremaining: 7m 32s\n",
            "294:\tlearn: 18.8331410\ttest: 20.5456515\tbest: 20.5446662 (293)\ttotal: 3m 9s\tremaining: 7m 32s\n",
            "295:\tlearn: 18.8306180\ttest: 20.5457882\tbest: 20.5446662 (293)\ttotal: 3m 10s\tremaining: 7m 32s\n",
            "296:\tlearn: 18.8235195\ttest: 20.5398332\tbest: 20.5398332 (296)\ttotal: 3m 10s\tremaining: 7m 31s\n",
            "297:\tlearn: 18.7936468\ttest: 20.5179253\tbest: 20.5179253 (297)\ttotal: 3m 11s\tremaining: 7m 30s\n",
            "298:\tlearn: 18.7871705\ttest: 20.5123094\tbest: 20.5123094 (298)\ttotal: 3m 11s\tremaining: 7m 29s\n",
            "299:\tlearn: 18.7739364\ttest: 20.4996444\tbest: 20.4996444 (299)\ttotal: 3m 12s\tremaining: 7m 29s\n",
            "300:\tlearn: 18.7702161\ttest: 20.4988250\tbest: 20.4988250 (300)\ttotal: 3m 12s\tremaining: 7m 28s\n",
            "301:\tlearn: 18.7615119\ttest: 20.4905338\tbest: 20.4905338 (301)\ttotal: 3m 13s\tremaining: 7m 27s\n",
            "302:\tlearn: 18.7575476\ttest: 20.4876801\tbest: 20.4876801 (302)\ttotal: 3m 13s\tremaining: 7m 26s\n",
            "303:\tlearn: 18.7476950\ttest: 20.4826500\tbest: 20.4826500 (303)\ttotal: 3m 14s\tremaining: 7m 25s\n",
            "304:\tlearn: 18.7395179\ttest: 20.4760812\tbest: 20.4760812 (304)\ttotal: 3m 15s\tremaining: 7m 24s\n",
            "305:\tlearn: 18.7325274\ttest: 20.4735151\tbest: 20.4735151 (305)\ttotal: 3m 15s\tremaining: 7m 23s\n",
            "306:\tlearn: 18.7190726\ttest: 20.4639804\tbest: 20.4639804 (306)\ttotal: 3m 16s\tremaining: 7m 23s\n",
            "307:\tlearn: 18.7103767\ttest: 20.4552083\tbest: 20.4552083 (307)\ttotal: 3m 16s\tremaining: 7m 22s\n",
            "308:\tlearn: 18.6950845\ttest: 20.4421938\tbest: 20.4421938 (308)\ttotal: 3m 17s\tremaining: 7m 21s\n",
            "309:\tlearn: 18.6834801\ttest: 20.4368213\tbest: 20.4368213 (309)\ttotal: 3m 17s\tremaining: 7m 20s\n",
            "310:\tlearn: 18.6795362\ttest: 20.4342699\tbest: 20.4342699 (310)\ttotal: 3m 18s\tremaining: 7m 19s\n",
            "311:\tlearn: 18.6558836\ttest: 20.4121207\tbest: 20.4121207 (311)\ttotal: 3m 19s\tremaining: 7m 18s\n",
            "312:\tlearn: 18.6503591\ttest: 20.4091679\tbest: 20.4091679 (312)\ttotal: 3m 19s\tremaining: 7m 17s\n",
            "313:\tlearn: 18.6441655\ttest: 20.4078085\tbest: 20.4078085 (313)\ttotal: 3m 20s\tremaining: 7m 17s\n",
            "314:\tlearn: 18.6043268\ttest: 20.3892135\tbest: 20.3892135 (314)\ttotal: 3m 20s\tremaining: 7m 16s\n",
            "315:\tlearn: 18.5958145\ttest: 20.3822415\tbest: 20.3822415 (315)\ttotal: 3m 21s\tremaining: 7m 17s\n",
            "316:\tlearn: 18.5839221\ttest: 20.3704025\tbest: 20.3704025 (316)\ttotal: 3m 22s\tremaining: 7m 17s\n",
            "317:\tlearn: 18.5741883\ttest: 20.3721537\tbest: 20.3704025 (316)\ttotal: 3m 23s\tremaining: 7m 17s\n",
            "318:\tlearn: 18.5622213\ttest: 20.3593038\tbest: 20.3593038 (318)\ttotal: 3m 24s\tremaining: 7m 16s\n",
            "319:\tlearn: 18.5472655\ttest: 20.3542073\tbest: 20.3542073 (319)\ttotal: 3m 24s\tremaining: 7m 15s\n",
            "320:\tlearn: 18.5271799\ttest: 20.3487476\tbest: 20.3487476 (320)\ttotal: 3m 25s\tremaining: 7m 14s\n",
            "321:\tlearn: 18.5190284\ttest: 20.3505580\tbest: 20.3487476 (320)\ttotal: 3m 26s\tremaining: 7m 13s\n",
            "322:\tlearn: 18.5105659\ttest: 20.3407187\tbest: 20.3407187 (322)\ttotal: 3m 26s\tremaining: 7m 12s\n",
            "323:\tlearn: 18.5076545\ttest: 20.3404408\tbest: 20.3404408 (323)\ttotal: 3m 27s\tremaining: 7m 12s\n",
            "324:\tlearn: 18.4999263\ttest: 20.3388771\tbest: 20.3388771 (324)\ttotal: 3m 27s\tremaining: 7m 11s\n",
            "325:\tlearn: 18.4951041\ttest: 20.3350565\tbest: 20.3350565 (325)\ttotal: 3m 28s\tremaining: 7m 10s\n",
            "326:\tlearn: 18.4862038\ttest: 20.3319934\tbest: 20.3319934 (326)\ttotal: 3m 28s\tremaining: 7m 10s\n",
            "327:\tlearn: 18.4763160\ttest: 20.3296579\tbest: 20.3296579 (327)\ttotal: 3m 29s\tremaining: 7m 9s\n",
            "328:\tlearn: 18.4695836\ttest: 20.3280589\tbest: 20.3280589 (328)\ttotal: 3m 30s\tremaining: 7m 8s\n",
            "329:\tlearn: 18.4575147\ttest: 20.3162978\tbest: 20.3162978 (329)\ttotal: 3m 30s\tremaining: 7m 7s\n",
            "330:\tlearn: 18.4521444\ttest: 20.3144879\tbest: 20.3144879 (330)\ttotal: 3m 31s\tremaining: 7m 7s\n",
            "331:\tlearn: 18.4187135\ttest: 20.3021489\tbest: 20.3021489 (331)\ttotal: 3m 31s\tremaining: 7m 6s\n",
            "332:\tlearn: 18.4090749\ttest: 20.2933843\tbest: 20.2933843 (332)\ttotal: 3m 32s\tremaining: 7m 5s\n",
            "333:\tlearn: 18.4001817\ttest: 20.2836279\tbest: 20.2836279 (333)\ttotal: 3m 33s\tremaining: 7m 4s\n",
            "334:\tlearn: 18.3865197\ttest: 20.2775355\tbest: 20.2775355 (334)\ttotal: 3m 33s\tremaining: 7m 4s\n",
            "335:\tlearn: 18.3684569\ttest: 20.2632328\tbest: 20.2632328 (335)\ttotal: 3m 34s\tremaining: 7m 3s\n",
            "336:\tlearn: 18.3580459\ttest: 20.2585127\tbest: 20.2585127 (336)\ttotal: 3m 34s\tremaining: 7m 2s\n",
            "337:\tlearn: 18.3378052\ttest: 20.2457228\tbest: 20.2457228 (337)\ttotal: 3m 35s\tremaining: 7m 2s\n",
            "338:\tlearn: 18.3308207\ttest: 20.2429025\tbest: 20.2429025 (338)\ttotal: 3m 36s\tremaining: 7m 2s\n",
            "339:\tlearn: 18.3257606\ttest: 20.2444881\tbest: 20.2429025 (338)\ttotal: 3m 37s\tremaining: 7m 2s\n",
            "340:\tlearn: 18.3164180\ttest: 20.2398442\tbest: 20.2398442 (340)\ttotal: 3m 38s\tremaining: 7m 2s\n",
            "341:\tlearn: 18.2895584\ttest: 20.2287661\tbest: 20.2287661 (341)\ttotal: 3m 39s\tremaining: 7m 1s\n",
            "342:\tlearn: 18.2718099\ttest: 20.1887078\tbest: 20.1887078 (342)\ttotal: 3m 39s\tremaining: 7m 1s\n",
            "343:\tlearn: 18.2619585\ttest: 20.1829944\tbest: 20.1829944 (343)\ttotal: 3m 40s\tremaining: 7m\n",
            "344:\tlearn: 18.2543333\ttest: 20.1775787\tbest: 20.1775787 (344)\ttotal: 3m 41s\tremaining: 6m 59s\n",
            "345:\tlearn: 18.2484696\ttest: 20.1776289\tbest: 20.1775787 (344)\ttotal: 3m 41s\tremaining: 6m 58s\n",
            "346:\tlearn: 18.2407014\ttest: 20.1725254\tbest: 20.1725254 (346)\ttotal: 3m 42s\tremaining: 6m 57s\n",
            "347:\tlearn: 18.2395488\ttest: 20.1729789\tbest: 20.1725254 (346)\ttotal: 3m 42s\tremaining: 6m 57s\n",
            "348:\tlearn: 18.2286549\ttest: 20.1643684\tbest: 20.1643684 (348)\ttotal: 3m 43s\tremaining: 6m 56s\n",
            "349:\tlearn: 18.2214793\ttest: 20.1592928\tbest: 20.1592928 (349)\ttotal: 3m 43s\tremaining: 6m 55s\n",
            "350:\tlearn: 18.2123154\ttest: 20.1512689\tbest: 20.1512689 (350)\ttotal: 3m 44s\tremaining: 6m 54s\n",
            "351:\tlearn: 18.2042713\ttest: 20.1494667\tbest: 20.1494667 (351)\ttotal: 3m 44s\tremaining: 6m 53s\n",
            "352:\tlearn: 18.1857052\ttest: 20.1354140\tbest: 20.1354140 (352)\ttotal: 3m 45s\tremaining: 6m 53s\n",
            "353:\tlearn: 18.1761307\ttest: 20.1220677\tbest: 20.1220677 (353)\ttotal: 3m 45s\tremaining: 6m 52s\n",
            "354:\tlearn: 18.1658831\ttest: 20.1094391\tbest: 20.1094391 (354)\ttotal: 3m 46s\tremaining: 6m 51s\n",
            "355:\tlearn: 18.1606441\ttest: 20.1079614\tbest: 20.1079614 (355)\ttotal: 3m 47s\tremaining: 6m 50s\n",
            "356:\tlearn: 18.1366697\ttest: 20.0998446\tbest: 20.0998446 (356)\ttotal: 3m 47s\tremaining: 6m 49s\n",
            "357:\tlearn: 18.1301047\ttest: 20.0966227\tbest: 20.0966227 (357)\ttotal: 3m 48s\tremaining: 6m 49s\n",
            "358:\tlearn: 18.1186236\ttest: 20.0902888\tbest: 20.0902888 (358)\ttotal: 3m 48s\tremaining: 6m 48s\n",
            "359:\tlearn: 18.1099903\ttest: 20.0842914\tbest: 20.0842914 (359)\ttotal: 3m 49s\tremaining: 6m 48s\n",
            "360:\tlearn: 18.0897049\ttest: 20.0649038\tbest: 20.0649038 (360)\ttotal: 3m 50s\tremaining: 6m 48s\n",
            "361:\tlearn: 18.0794397\ttest: 20.0490707\tbest: 20.0490707 (361)\ttotal: 3m 51s\tremaining: 6m 48s\n",
            "362:\tlearn: 18.0692299\ttest: 20.0405704\tbest: 20.0405704 (362)\ttotal: 3m 52s\tremaining: 6m 48s\n",
            "363:\tlearn: 18.0496503\ttest: 20.0326405\tbest: 20.0326405 (363)\ttotal: 3m 53s\tremaining: 6m 47s\n",
            "364:\tlearn: 18.0428586\ttest: 20.0263544\tbest: 20.0263544 (364)\ttotal: 3m 53s\tremaining: 6m 46s\n",
            "365:\tlearn: 18.0358857\ttest: 20.0240607\tbest: 20.0240607 (365)\ttotal: 3m 54s\tremaining: 6m 46s\n",
            "366:\tlearn: 18.0267307\ttest: 20.0197143\tbest: 20.0197143 (366)\ttotal: 3m 55s\tremaining: 6m 45s\n",
            "367:\tlearn: 18.0226662\ttest: 20.0181955\tbest: 20.0181955 (367)\ttotal: 3m 55s\tremaining: 6m 44s\n",
            "368:\tlearn: 18.0205224\ttest: 20.0174656\tbest: 20.0174656 (368)\ttotal: 3m 56s\tremaining: 6m 43s\n",
            "369:\tlearn: 18.0107365\ttest: 20.0117723\tbest: 20.0117723 (369)\ttotal: 3m 56s\tremaining: 6m 43s\n",
            "370:\tlearn: 17.9977757\ttest: 20.0092462\tbest: 20.0092462 (370)\ttotal: 3m 57s\tremaining: 6m 42s\n",
            "371:\tlearn: 17.9892447\ttest: 20.0046065\tbest: 20.0046065 (371)\ttotal: 3m 57s\tremaining: 6m 41s\n",
            "372:\tlearn: 17.9842904\ttest: 20.0020847\tbest: 20.0020847 (372)\ttotal: 3m 58s\tremaining: 6m 41s\n",
            "373:\tlearn: 17.9753784\ttest: 19.9953380\tbest: 19.9953380 (373)\ttotal: 3m 59s\tremaining: 6m 40s\n",
            "374:\tlearn: 17.9719692\ttest: 19.9950855\tbest: 19.9950855 (374)\ttotal: 3m 59s\tremaining: 6m 39s\n",
            "375:\tlearn: 17.9628117\ttest: 19.9832568\tbest: 19.9832568 (375)\ttotal: 4m\tremaining: 6m 38s\n",
            "376:\tlearn: 17.9480978\ttest: 19.9549316\tbest: 19.9549316 (376)\ttotal: 4m\tremaining: 6m 38s\n",
            "377:\tlearn: 17.9414543\ttest: 19.9464918\tbest: 19.9464918 (377)\ttotal: 4m 1s\tremaining: 6m 37s\n",
            "378:\tlearn: 17.9297569\ttest: 19.9266760\tbest: 19.9266760 (378)\ttotal: 4m 2s\tremaining: 6m 36s\n",
            "379:\tlearn: 17.9217078\ttest: 19.9183182\tbest: 19.9183182 (379)\ttotal: 4m 2s\tremaining: 6m 35s\n",
            "380:\tlearn: 17.9133126\ttest: 19.9126753\tbest: 19.9126753 (380)\ttotal: 4m 3s\tremaining: 6m 35s\n",
            "381:\tlearn: 17.9092252\ttest: 19.9093867\tbest: 19.9093867 (381)\ttotal: 4m 3s\tremaining: 6m 34s\n",
            "382:\tlearn: 17.9055097\ttest: 19.9073818\tbest: 19.9073818 (382)\ttotal: 4m 4s\tremaining: 6m 34s\n",
            "383:\tlearn: 17.8911291\ttest: 19.8920072\tbest: 19.8920072 (383)\ttotal: 4m 5s\tremaining: 6m 34s\n",
            "384:\tlearn: 17.8777706\ttest: 19.8690132\tbest: 19.8690132 (384)\ttotal: 4m 6s\tremaining: 6m 34s\n",
            "385:\tlearn: 17.8693588\ttest: 19.8544696\tbest: 19.8544696 (385)\ttotal: 4m 7s\tremaining: 6m 34s\n",
            "386:\tlearn: 17.8648794\ttest: 19.8521600\tbest: 19.8521600 (386)\ttotal: 4m 8s\tremaining: 6m 33s\n",
            "387:\tlearn: 17.8605960\ttest: 19.8497656\tbest: 19.8497656 (387)\ttotal: 4m 9s\tremaining: 6m 32s\n",
            "388:\tlearn: 17.8531109\ttest: 19.8482731\tbest: 19.8482731 (388)\ttotal: 4m 9s\tremaining: 6m 32s\n",
            "389:\tlearn: 17.8445535\ttest: 19.8421941\tbest: 19.8421941 (389)\ttotal: 4m 10s\tremaining: 6m 31s\n",
            "390:\tlearn: 17.8380182\ttest: 19.8375548\tbest: 19.8375548 (390)\ttotal: 4m 10s\tremaining: 6m 30s\n",
            "391:\tlearn: 17.8311581\ttest: 19.8316520\tbest: 19.8316520 (391)\ttotal: 4m 11s\tremaining: 6m 29s\n",
            "392:\tlearn: 17.8284467\ttest: 19.8300193\tbest: 19.8300193 (392)\ttotal: 4m 11s\tremaining: 6m 29s\n",
            "393:\tlearn: 17.8219286\ttest: 19.8226906\tbest: 19.8226906 (393)\ttotal: 4m 12s\tremaining: 6m 28s\n",
            "394:\tlearn: 17.8184650\ttest: 19.8200328\tbest: 19.8200328 (394)\ttotal: 4m 13s\tremaining: 6m 27s\n",
            "395:\tlearn: 17.8110625\ttest: 19.8133807\tbest: 19.8133807 (395)\ttotal: 4m 13s\tremaining: 6m 26s\n",
            "396:\tlearn: 17.8008907\ttest: 19.8067343\tbest: 19.8067343 (396)\ttotal: 4m 14s\tremaining: 6m 26s\n",
            "397:\tlearn: 17.7837067\ttest: 19.8006619\tbest: 19.8006619 (397)\ttotal: 4m 14s\tremaining: 6m 25s\n",
            "398:\tlearn: 17.7795309\ttest: 19.7980447\tbest: 19.7980447 (398)\ttotal: 4m 15s\tremaining: 6m 24s\n",
            "399:\tlearn: 17.7776172\ttest: 19.7972895\tbest: 19.7972895 (399)\ttotal: 4m 15s\tremaining: 6m 23s\n",
            "400:\tlearn: 17.7717460\ttest: 19.7903245\tbest: 19.7903245 (400)\ttotal: 4m 16s\tremaining: 6m 22s\n",
            "401:\tlearn: 17.7666290\ttest: 19.7858670\tbest: 19.7858670 (401)\ttotal: 4m 16s\tremaining: 6m 22s\n",
            "402:\tlearn: 17.7626902\ttest: 19.7851712\tbest: 19.7851712 (402)\ttotal: 4m 17s\tremaining: 6m 21s\n",
            "403:\tlearn: 17.7585925\ttest: 19.7798110\tbest: 19.7798110 (403)\ttotal: 4m 18s\tremaining: 6m 20s\n",
            "404:\tlearn: 17.7472280\ttest: 19.7667929\tbest: 19.7667929 (404)\ttotal: 4m 19s\tremaining: 6m 20s\n",
            "405:\tlearn: 17.7430662\ttest: 19.7647874\tbest: 19.7647874 (405)\ttotal: 4m 20s\tremaining: 6m 20s\n",
            "406:\tlearn: 17.7390365\ttest: 19.7663840\tbest: 19.7647874 (405)\ttotal: 4m 21s\tremaining: 6m 20s\n",
            "407:\tlearn: 17.7309382\ttest: 19.7594865\tbest: 19.7594865 (407)\ttotal: 4m 22s\tremaining: 6m 20s\n",
            "408:\tlearn: 17.7206798\ttest: 19.7503246\tbest: 19.7503246 (408)\ttotal: 4m 22s\tremaining: 6m 19s\n",
            "409:\tlearn: 17.7117276\ttest: 19.7464794\tbest: 19.7464794 (409)\ttotal: 4m 23s\tremaining: 6m 19s\n",
            "410:\tlearn: 17.7059195\ttest: 19.7415599\tbest: 19.7415599 (410)\ttotal: 4m 23s\tremaining: 6m 18s\n",
            "411:\tlearn: 17.6976977\ttest: 19.7329357\tbest: 19.7329357 (411)\ttotal: 4m 24s\tremaining: 6m 17s\n",
            "412:\tlearn: 17.6912956\ttest: 19.7294959\tbest: 19.7294959 (412)\ttotal: 4m 25s\tremaining: 6m 16s\n",
            "413:\tlearn: 17.6823982\ttest: 19.7276779\tbest: 19.7276779 (413)\ttotal: 4m 25s\tremaining: 6m 15s\n",
            "414:\tlearn: 17.6802197\ttest: 19.7263144\tbest: 19.7263144 (414)\ttotal: 4m 26s\tremaining: 6m 15s\n",
            "415:\tlearn: 17.6771857\ttest: 19.7262168\tbest: 19.7262168 (415)\ttotal: 4m 26s\tremaining: 6m 14s\n",
            "416:\tlearn: 17.6661469\ttest: 19.7090628\tbest: 19.7090628 (416)\ttotal: 4m 27s\tremaining: 6m 13s\n",
            "417:\tlearn: 17.6587987\ttest: 19.7032381\tbest: 19.7032381 (417)\ttotal: 4m 27s\tremaining: 6m 12s\n",
            "418:\tlearn: 17.6505846\ttest: 19.6975570\tbest: 19.6975570 (418)\ttotal: 4m 28s\tremaining: 6m 12s\n",
            "419:\tlearn: 17.6476970\ttest: 19.6960188\tbest: 19.6960188 (419)\ttotal: 4m 29s\tremaining: 6m 11s\n",
            "420:\tlearn: 17.6443491\ttest: 19.6962539\tbest: 19.6960188 (419)\ttotal: 4m 29s\tremaining: 6m 10s\n",
            "421:\tlearn: 17.6383496\ttest: 19.6938955\tbest: 19.6938955 (421)\ttotal: 4m 30s\tremaining: 6m 10s\n",
            "422:\tlearn: 17.6373166\ttest: 19.6947049\tbest: 19.6938955 (421)\ttotal: 4m 30s\tremaining: 6m 9s\n",
            "423:\tlearn: 17.6158934\ttest: 19.6728166\tbest: 19.6728166 (423)\ttotal: 4m 31s\tremaining: 6m 8s\n",
            "424:\tlearn: 17.6088776\ttest: 19.6690958\tbest: 19.6690958 (424)\ttotal: 4m 31s\tremaining: 6m 7s\n",
            "425:\tlearn: 17.5924356\ttest: 19.6633798\tbest: 19.6633798 (425)\ttotal: 4m 32s\tremaining: 6m 7s\n",
            "426:\tlearn: 17.5864948\ttest: 19.6579989\tbest: 19.6579989 (426)\ttotal: 4m 33s\tremaining: 6m 6s\n",
            "427:\tlearn: 17.5813938\ttest: 19.6542532\tbest: 19.6542532 (427)\ttotal: 4m 34s\tremaining: 6m 6s\n",
            "428:\tlearn: 17.5751663\ttest: 19.6509658\tbest: 19.6509658 (428)\ttotal: 4m 35s\tremaining: 6m 6s\n",
            "429:\tlearn: 17.5705738\ttest: 19.6473861\tbest: 19.6473861 (429)\ttotal: 4m 36s\tremaining: 6m 6s\n",
            "430:\tlearn: 17.5673666\ttest: 19.6437631\tbest: 19.6437631 (430)\ttotal: 4m 37s\tremaining: 6m 5s\n",
            "431:\tlearn: 17.5591520\ttest: 19.6366777\tbest: 19.6366777 (431)\ttotal: 4m 37s\tremaining: 6m 5s\n",
            "432:\tlearn: 17.5563087\ttest: 19.6372926\tbest: 19.6366777 (431)\ttotal: 4m 38s\tremaining: 6m 4s\n",
            "433:\tlearn: 17.5479462\ttest: 19.6295211\tbest: 19.6295211 (433)\ttotal: 4m 38s\tremaining: 6m 3s\n",
            "434:\tlearn: 17.5422294\ttest: 19.6249189\tbest: 19.6249189 (434)\ttotal: 4m 39s\tremaining: 6m 3s\n",
            "435:\tlearn: 17.5405759\ttest: 19.6251786\tbest: 19.6249189 (434)\ttotal: 4m 40s\tremaining: 6m 2s\n",
            "436:\tlearn: 17.5297442\ttest: 19.6127133\tbest: 19.6127133 (436)\ttotal: 4m 40s\tremaining: 6m 1s\n",
            "437:\tlearn: 17.5266762\ttest: 19.6106481\tbest: 19.6106481 (437)\ttotal: 4m 41s\tremaining: 6m 1s\n",
            "438:\tlearn: 17.5142863\ttest: 19.5964847\tbest: 19.5964847 (438)\ttotal: 4m 42s\tremaining: 6m\n",
            "439:\tlearn: 17.5124467\ttest: 19.5961708\tbest: 19.5961708 (439)\ttotal: 4m 42s\tremaining: 5m 59s\n",
            "440:\tlearn: 17.5077669\ttest: 19.5956679\tbest: 19.5956679 (440)\ttotal: 4m 43s\tremaining: 5m 58s\n",
            "441:\tlearn: 17.5042156\ttest: 19.5950884\tbest: 19.5950884 (441)\ttotal: 4m 43s\tremaining: 5m 58s\n",
            "442:\tlearn: 17.5027570\ttest: 19.5941781\tbest: 19.5941781 (442)\ttotal: 4m 44s\tremaining: 5m 57s\n",
            "443:\tlearn: 17.4957358\ttest: 19.5868306\tbest: 19.5868306 (443)\ttotal: 4m 44s\tremaining: 5m 56s\n",
            "444:\tlearn: 17.4868609\ttest: 19.5775317\tbest: 19.5775317 (444)\ttotal: 4m 45s\tremaining: 5m 55s\n",
            "445:\tlearn: 17.4775453\ttest: 19.5710013\tbest: 19.5710013 (445)\ttotal: 4m 45s\tremaining: 5m 55s\n",
            "446:\tlearn: 17.4745903\ttest: 19.5696150\tbest: 19.5696150 (446)\ttotal: 4m 46s\tremaining: 5m 54s\n",
            "447:\tlearn: 17.4683485\ttest: 19.5685561\tbest: 19.5685561 (447)\ttotal: 4m 47s\tremaining: 5m 53s\n",
            "448:\tlearn: 17.4641846\ttest: 19.5675990\tbest: 19.5675990 (448)\ttotal: 4m 48s\tremaining: 5m 53s\n",
            "449:\tlearn: 17.4616999\ttest: 19.5649174\tbest: 19.5649174 (449)\ttotal: 4m 49s\tremaining: 5m 53s\n",
            "450:\tlearn: 17.4518828\ttest: 19.5617195\tbest: 19.5617195 (450)\ttotal: 4m 50s\tremaining: 5m 53s\n",
            "451:\tlearn: 17.4380345\ttest: 19.5451765\tbest: 19.5451765 (451)\ttotal: 4m 51s\tremaining: 5m 53s\n",
            "452:\tlearn: 17.4293385\ttest: 19.5427126\tbest: 19.5427126 (452)\ttotal: 4m 51s\tremaining: 5m 52s\n",
            "453:\tlearn: 17.4243660\ttest: 19.5411381\tbest: 19.5411381 (453)\ttotal: 4m 52s\tremaining: 5m 51s\n",
            "454:\tlearn: 17.4215749\ttest: 19.5384493\tbest: 19.5384493 (454)\ttotal: 4m 52s\tremaining: 5m 50s\n",
            "455:\tlearn: 17.4159432\ttest: 19.5360842\tbest: 19.5360842 (455)\ttotal: 4m 53s\tremaining: 5m 49s\n",
            "456:\tlearn: 17.3981543\ttest: 19.5026481\tbest: 19.5026481 (456)\ttotal: 4m 53s\tremaining: 5m 49s\n",
            "457:\tlearn: 17.3951389\ttest: 19.5014002\tbest: 19.5014002 (457)\ttotal: 4m 54s\tremaining: 5m 48s\n",
            "458:\tlearn: 17.3895532\ttest: 19.4983941\tbest: 19.4983941 (458)\ttotal: 4m 55s\tremaining: 5m 47s\n",
            "459:\tlearn: 17.3840364\ttest: 19.4980257\tbest: 19.4980257 (459)\ttotal: 4m 55s\tremaining: 5m 47s\n",
            "460:\tlearn: 17.3770564\ttest: 19.4933838\tbest: 19.4933838 (460)\ttotal: 4m 56s\tremaining: 5m 46s\n",
            "461:\tlearn: 17.3711946\ttest: 19.4908972\tbest: 19.4908972 (461)\ttotal: 4m 56s\tremaining: 5m 45s\n",
            "462:\tlearn: 17.3635569\ttest: 19.4849673\tbest: 19.4849673 (462)\ttotal: 4m 57s\tremaining: 5m 44s\n",
            "463:\tlearn: 17.3580125\ttest: 19.4812487\tbest: 19.4812487 (463)\ttotal: 4m 57s\tremaining: 5m 44s\n",
            "464:\tlearn: 17.3513499\ttest: 19.4768966\tbest: 19.4768966 (464)\ttotal: 4m 58s\tremaining: 5m 43s\n",
            "465:\tlearn: 17.3385005\ttest: 19.4485299\tbest: 19.4485299 (465)\ttotal: 4m 59s\tremaining: 5m 42s\n",
            "466:\tlearn: 17.3355956\ttest: 19.4474116\tbest: 19.4474116 (466)\ttotal: 4m 59s\tremaining: 5m 41s\n",
            "467:\tlearn: 17.3291429\ttest: 19.4446997\tbest: 19.4446997 (467)\ttotal: 5m\tremaining: 5m 41s\n",
            "468:\tlearn: 17.3272322\ttest: 19.4456194\tbest: 19.4446997 (467)\ttotal: 5m\tremaining: 5m 40s\n",
            "469:\tlearn: 17.3150716\ttest: 19.4398055\tbest: 19.4398055 (469)\ttotal: 5m 1s\tremaining: 5m 39s\n",
            "470:\tlearn: 17.3105344\ttest: 19.4382456\tbest: 19.4382456 (470)\ttotal: 5m 2s\tremaining: 5m 39s\n",
            "471:\tlearn: 17.3012323\ttest: 19.4271894\tbest: 19.4271894 (471)\ttotal: 5m 3s\tremaining: 5m 39s\n",
            "472:\tlearn: 17.2958303\ttest: 19.4240530\tbest: 19.4240530 (472)\ttotal: 5m 4s\tremaining: 5m 39s\n",
            "473:\tlearn: 17.2906460\ttest: 19.4184100\tbest: 19.4184100 (473)\ttotal: 5m 5s\tremaining: 5m 38s\n",
            "474:\tlearn: 17.2847082\ttest: 19.4165361\tbest: 19.4165361 (474)\ttotal: 5m 6s\tremaining: 5m 38s\n",
            "475:\tlearn: 17.2708589\ttest: 19.4122615\tbest: 19.4122615 (475)\ttotal: 5m 6s\tremaining: 5m 37s\n",
            "476:\tlearn: 17.2589508\ttest: 19.3950127\tbest: 19.3950127 (476)\ttotal: 5m 7s\tremaining: 5m 36s\n",
            "477:\tlearn: 17.2536239\ttest: 19.3933092\tbest: 19.3933092 (477)\ttotal: 5m 7s\tremaining: 5m 35s\n",
            "478:\tlearn: 17.2426201\ttest: 19.3818930\tbest: 19.3818930 (478)\ttotal: 5m 8s\tremaining: 5m 35s\n",
            "479:\tlearn: 17.2374355\ttest: 19.3814527\tbest: 19.3814527 (479)\ttotal: 5m 8s\tremaining: 5m 34s\n",
            "480:\tlearn: 17.2335861\ttest: 19.3773098\tbest: 19.3773098 (480)\ttotal: 5m 9s\tremaining: 5m 33s\n",
            "481:\tlearn: 17.2266788\ttest: 19.3708611\tbest: 19.3708611 (481)\ttotal: 5m 9s\tremaining: 5m 33s\n",
            "482:\tlearn: 17.2176761\ttest: 19.3617513\tbest: 19.3617513 (482)\ttotal: 5m 10s\tremaining: 5m 32s\n",
            "483:\tlearn: 17.2102796\ttest: 19.3589453\tbest: 19.3589453 (483)\ttotal: 5m 10s\tremaining: 5m 31s\n",
            "484:\tlearn: 17.2072346\ttest: 19.3580596\tbest: 19.3580596 (484)\ttotal: 5m 11s\tremaining: 5m 30s\n",
            "485:\tlearn: 17.2050933\ttest: 19.3570254\tbest: 19.3570254 (485)\ttotal: 5m 12s\tremaining: 5m 30s\n",
            "486:\tlearn: 17.1990506\ttest: 19.3543821\tbest: 19.3543821 (486)\ttotal: 5m 12s\tremaining: 5m 29s\n",
            "487:\tlearn: 17.1915249\ttest: 19.3498533\tbest: 19.3498533 (487)\ttotal: 5m 13s\tremaining: 5m 28s\n",
            "488:\tlearn: 17.1814735\ttest: 19.3346575\tbest: 19.3346575 (488)\ttotal: 5m 13s\tremaining: 5m 27s\n",
            "489:\tlearn: 17.1719665\ttest: 19.3280623\tbest: 19.3280623 (489)\ttotal: 5m 14s\tremaining: 5m 27s\n",
            "490:\tlearn: 17.1643693\ttest: 19.3232890\tbest: 19.3232890 (490)\ttotal: 5m 14s\tremaining: 5m 26s\n",
            "491:\tlearn: 17.1556988\ttest: 19.3180287\tbest: 19.3180287 (491)\ttotal: 5m 15s\tremaining: 5m 25s\n",
            "492:\tlearn: 17.1468267\ttest: 19.3125858\tbest: 19.3125858 (492)\ttotal: 5m 16s\tremaining: 5m 25s\n",
            "493:\tlearn: 17.1451947\ttest: 19.3123302\tbest: 19.3123302 (493)\ttotal: 5m 17s\tremaining: 5m 25s\n",
            "494:\tlearn: 17.1366436\ttest: 19.3127659\tbest: 19.3123302 (493)\ttotal: 5m 18s\tremaining: 5m 24s\n",
            "495:\tlearn: 17.1310295\ttest: 19.3095638\tbest: 19.3095638 (495)\ttotal: 5m 19s\tremaining: 5m 24s\n",
            "496:\tlearn: 17.1256243\ttest: 19.3044254\tbest: 19.3044254 (496)\ttotal: 5m 20s\tremaining: 5m 24s\n",
            "497:\tlearn: 17.1213466\ttest: 19.3021324\tbest: 19.3021324 (497)\ttotal: 5m 20s\tremaining: 5m 23s\n",
            "498:\tlearn: 17.1150520\ttest: 19.2964332\tbest: 19.2964332 (498)\ttotal: 5m 21s\tremaining: 5m 22s\n",
            "499:\tlearn: 17.1136120\ttest: 19.2958128\tbest: 19.2958128 (499)\ttotal: 5m 22s\tremaining: 5m 22s\n",
            "500:\tlearn: 17.1077458\ttest: 19.2904291\tbest: 19.2904291 (500)\ttotal: 5m 22s\tremaining: 5m 21s\n",
            "501:\tlearn: 17.0930595\ttest: 19.2779043\tbest: 19.2779043 (501)\ttotal: 5m 23s\tremaining: 5m 20s\n",
            "502:\tlearn: 17.0857439\ttest: 19.2702647\tbest: 19.2702647 (502)\ttotal: 5m 23s\tremaining: 5m 20s\n",
            "503:\tlearn: 17.0845304\ttest: 19.2705210\tbest: 19.2702647 (502)\ttotal: 5m 24s\tremaining: 5m 19s\n",
            "504:\tlearn: 17.0827050\ttest: 19.2706137\tbest: 19.2702647 (502)\ttotal: 5m 24s\tremaining: 5m 18s\n",
            "505:\tlearn: 17.0768624\ttest: 19.2666328\tbest: 19.2666328 (505)\ttotal: 5m 25s\tremaining: 5m 17s\n",
            "506:\tlearn: 17.0759622\ttest: 19.2670736\tbest: 19.2666328 (505)\ttotal: 5m 26s\tremaining: 5m 17s\n",
            "507:\tlearn: 17.0736255\ttest: 19.2679887\tbest: 19.2666328 (505)\ttotal: 5m 26s\tremaining: 5m 16s\n",
            "508:\tlearn: 17.0693779\ttest: 19.2647288\tbest: 19.2647288 (508)\ttotal: 5m 27s\tremaining: 5m 15s\n",
            "509:\tlearn: 17.0644567\ttest: 19.2605448\tbest: 19.2605448 (509)\ttotal: 5m 27s\tremaining: 5m 14s\n",
            "510:\tlearn: 17.0626408\ttest: 19.2605167\tbest: 19.2605167 (510)\ttotal: 5m 28s\tremaining: 5m 14s\n",
            "511:\tlearn: 17.0597694\ttest: 19.2568227\tbest: 19.2568227 (511)\ttotal: 5m 29s\tremaining: 5m 13s\n",
            "512:\tlearn: 17.0556837\ttest: 19.2570596\tbest: 19.2568227 (511)\ttotal: 5m 29s\tremaining: 5m 12s\n",
            "513:\tlearn: 17.0487611\ttest: 19.2530473\tbest: 19.2530473 (513)\ttotal: 5m 30s\tremaining: 5m 12s\n",
            "514:\tlearn: 17.0463189\ttest: 19.2512515\tbest: 19.2512515 (514)\ttotal: 5m 31s\tremaining: 5m 11s\n",
            "515:\tlearn: 17.0365150\ttest: 19.2429723\tbest: 19.2429723 (515)\ttotal: 5m 32s\tremaining: 5m 11s\n",
            "516:\tlearn: 17.0326975\ttest: 19.2423881\tbest: 19.2423881 (516)\ttotal: 5m 33s\tremaining: 5m 11s\n",
            "517:\tlearn: 17.0203305\ttest: 19.2353347\tbest: 19.2353347 (517)\ttotal: 5m 34s\tremaining: 5m 10s\n",
            "518:\tlearn: 17.0183160\ttest: 19.2351435\tbest: 19.2351435 (518)\ttotal: 5m 34s\tremaining: 5m 10s\n",
            "519:\tlearn: 17.0126927\ttest: 19.2298281\tbest: 19.2298281 (519)\ttotal: 5m 35s\tremaining: 5m 9s\n",
            "520:\tlearn: 17.0088506\ttest: 19.2279950\tbest: 19.2279950 (520)\ttotal: 5m 36s\tremaining: 5m 9s\n",
            "521:\tlearn: 17.0013174\ttest: 19.2192517\tbest: 19.2192517 (521)\ttotal: 5m 36s\tremaining: 5m 8s\n",
            "522:\tlearn: 16.9969034\ttest: 19.2155000\tbest: 19.2155000 (522)\ttotal: 5m 37s\tremaining: 5m 7s\n",
            "523:\tlearn: 16.9935652\ttest: 19.2158126\tbest: 19.2155000 (522)\ttotal: 5m 37s\tremaining: 5m 6s\n",
            "524:\tlearn: 16.9914509\ttest: 19.2156323\tbest: 19.2155000 (522)\ttotal: 5m 38s\tremaining: 5m 6s\n",
            "525:\tlearn: 16.9852303\ttest: 19.2106500\tbest: 19.2106500 (525)\ttotal: 5m 39s\tremaining: 5m 5s\n",
            "526:\tlearn: 16.9789495\ttest: 19.2051624\tbest: 19.2051624 (526)\ttotal: 5m 39s\tremaining: 5m 4s\n",
            "527:\tlearn: 16.9747819\ttest: 19.2047264\tbest: 19.2047264 (527)\ttotal: 5m 40s\tremaining: 5m 4s\n",
            "528:\tlearn: 16.9673471\ttest: 19.1971764\tbest: 19.1971764 (528)\ttotal: 5m 40s\tremaining: 5m 3s\n",
            "529:\tlearn: 16.9637200\ttest: 19.1956329\tbest: 19.1956329 (529)\ttotal: 5m 41s\tremaining: 5m 2s\n",
            "530:\tlearn: 16.9588172\ttest: 19.1964099\tbest: 19.1956329 (529)\ttotal: 5m 41s\tremaining: 5m 2s\n",
            "531:\tlearn: 16.9555764\ttest: 19.1951087\tbest: 19.1951087 (531)\ttotal: 5m 42s\tremaining: 5m 1s\n",
            "532:\tlearn: 16.9525107\ttest: 19.1960420\tbest: 19.1951087 (531)\ttotal: 5m 43s\tremaining: 5m\n",
            "533:\tlearn: 16.9426841\ttest: 19.1878593\tbest: 19.1878593 (533)\ttotal: 5m 43s\tremaining: 4m 59s\n",
            "534:\tlearn: 16.9362556\ttest: 19.1881781\tbest: 19.1878593 (533)\ttotal: 5m 44s\tremaining: 4m 58s\n",
            "535:\tlearn: 16.9346538\ttest: 19.1890731\tbest: 19.1878593 (533)\ttotal: 5m 44s\tremaining: 4m 58s\n",
            "536:\tlearn: 16.9332654\ttest: 19.1894457\tbest: 19.1878593 (533)\ttotal: 5m 45s\tremaining: 4m 57s\n",
            "537:\tlearn: 16.9303888\ttest: 19.1871445\tbest: 19.1871445 (537)\ttotal: 5m 46s\tremaining: 4m 57s\n",
            "538:\tlearn: 16.9262495\ttest: 19.1821574\tbest: 19.1821574 (538)\ttotal: 5m 47s\tremaining: 4m 57s\n",
            "539:\tlearn: 16.9231464\ttest: 19.1814495\tbest: 19.1814495 (539)\ttotal: 5m 48s\tremaining: 4m 57s\n",
            "540:\tlearn: 16.9211578\ttest: 19.1802564\tbest: 19.1802564 (540)\ttotal: 5m 49s\tremaining: 4m 56s\n",
            "541:\tlearn: 16.9196882\ttest: 19.1799479\tbest: 19.1799479 (541)\ttotal: 5m 49s\tremaining: 4m 55s\n",
            "542:\tlearn: 16.9169968\ttest: 19.1785534\tbest: 19.1785534 (542)\ttotal: 5m 50s\tremaining: 4m 55s\n",
            "543:\tlearn: 16.9110312\ttest: 19.1719759\tbest: 19.1719759 (543)\ttotal: 5m 51s\tremaining: 4m 54s\n",
            "544:\tlearn: 16.9058851\ttest: 19.1741862\tbest: 19.1719759 (543)\ttotal: 5m 51s\tremaining: 4m 53s\n",
            "545:\tlearn: 16.9018847\ttest: 19.1725831\tbest: 19.1719759 (543)\ttotal: 5m 52s\tremaining: 4m 52s\n",
            "546:\tlearn: 16.8989061\ttest: 19.1722855\tbest: 19.1719759 (543)\ttotal: 5m 52s\tremaining: 4m 52s\n",
            "547:\tlearn: 16.8959781\ttest: 19.1700426\tbest: 19.1700426 (547)\ttotal: 5m 53s\tremaining: 4m 51s\n",
            "548:\tlearn: 16.8908459\ttest: 19.1635689\tbest: 19.1635689 (548)\ttotal: 5m 53s\tremaining: 4m 50s\n",
            "549:\tlearn: 16.8868202\ttest: 19.1620158\tbest: 19.1620158 (549)\ttotal: 5m 54s\tremaining: 4m 50s\n",
            "550:\tlearn: 16.8836307\ttest: 19.1625758\tbest: 19.1620158 (549)\ttotal: 5m 55s\tremaining: 4m 49s\n",
            "551:\tlearn: 16.8771304\ttest: 19.1608062\tbest: 19.1608062 (551)\ttotal: 5m 55s\tremaining: 4m 48s\n",
            "552:\tlearn: 16.8736952\ttest: 19.1591772\tbest: 19.1591772 (552)\ttotal: 5m 56s\tremaining: 4m 48s\n",
            "553:\tlearn: 16.8708522\ttest: 19.1590170\tbest: 19.1590170 (553)\ttotal: 5m 56s\tremaining: 4m 47s\n",
            "554:\tlearn: 16.8692968\ttest: 19.1589494\tbest: 19.1589494 (554)\ttotal: 5m 57s\tremaining: 4m 46s\n",
            "555:\tlearn: 16.8643671\ttest: 19.1568993\tbest: 19.1568993 (555)\ttotal: 5m 58s\tremaining: 4m 46s\n",
            "556:\tlearn: 16.8595927\ttest: 19.1535691\tbest: 19.1535691 (556)\ttotal: 5m 58s\tremaining: 4m 45s\n",
            "557:\tlearn: 16.8566616\ttest: 19.1534318\tbest: 19.1534318 (557)\ttotal: 5m 59s\tremaining: 4m 44s\n",
            "558:\tlearn: 16.8499001\ttest: 19.1480593\tbest: 19.1480593 (558)\ttotal: 6m\tremaining: 4m 44s\n",
            "559:\tlearn: 16.8487303\ttest: 19.1483386\tbest: 19.1480593 (558)\ttotal: 6m 1s\tremaining: 4m 43s\n",
            "560:\tlearn: 16.8462954\ttest: 19.1458206\tbest: 19.1458206 (560)\ttotal: 6m 2s\tremaining: 4m 43s\n",
            "561:\tlearn: 16.8362802\ttest: 19.1415588\tbest: 19.1415588 (561)\ttotal: 6m 3s\tremaining: 4m 43s\n",
            "562:\tlearn: 16.8309901\ttest: 19.1371960\tbest: 19.1371960 (562)\ttotal: 6m 3s\tremaining: 4m 42s\n",
            "563:\tlearn: 16.8266012\ttest: 19.1328265\tbest: 19.1328265 (563)\ttotal: 6m 4s\tremaining: 4m 41s\n",
            "564:\tlearn: 16.8225139\ttest: 19.1295810\tbest: 19.1295810 (564)\ttotal: 6m 4s\tremaining: 4m 40s\n",
            "565:\tlearn: 16.8208076\ttest: 19.1292976\tbest: 19.1292976 (565)\ttotal: 6m 5s\tremaining: 4m 40s\n",
            "566:\tlearn: 16.8150696\ttest: 19.1278099\tbest: 19.1278099 (566)\ttotal: 6m 6s\tremaining: 4m 39s\n",
            "567:\tlearn: 16.8063548\ttest: 19.1184775\tbest: 19.1184775 (567)\ttotal: 6m 6s\tremaining: 4m 38s\n",
            "568:\tlearn: 16.8006479\ttest: 19.1172950\tbest: 19.1172950 (568)\ttotal: 6m 7s\tremaining: 4m 38s\n",
            "569:\tlearn: 16.7955122\ttest: 19.1162861\tbest: 19.1162861 (569)\ttotal: 6m 7s\tremaining: 4m 37s\n",
            "570:\tlearn: 16.7882694\ttest: 19.1158170\tbest: 19.1158170 (570)\ttotal: 6m 8s\tremaining: 4m 36s\n",
            "571:\tlearn: 16.7861917\ttest: 19.1158877\tbest: 19.1158170 (570)\ttotal: 6m 8s\tremaining: 4m 36s\n",
            "572:\tlearn: 16.7747170\ttest: 19.1061368\tbest: 19.1061368 (572)\ttotal: 6m 9s\tremaining: 4m 35s\n",
            "573:\tlearn: 16.7727915\ttest: 19.1049029\tbest: 19.1049029 (573)\ttotal: 6m 10s\tremaining: 4m 34s\n",
            "574:\tlearn: 16.7693366\ttest: 19.1049719\tbest: 19.1049029 (573)\ttotal: 6m 10s\tremaining: 4m 33s\n",
            "575:\tlearn: 16.7686116\ttest: 19.1052293\tbest: 19.1049029 (573)\ttotal: 6m 11s\tremaining: 4m 33s\n",
            "576:\tlearn: 16.7533804\ttest: 19.1008926\tbest: 19.1008926 (576)\ttotal: 6m 11s\tremaining: 4m 32s\n",
            "577:\tlearn: 16.7447382\ttest: 19.0959412\tbest: 19.0959412 (577)\ttotal: 6m 12s\tremaining: 4m 31s\n",
            "578:\tlearn: 16.7398253\ttest: 19.0961539\tbest: 19.0959412 (577)\ttotal: 6m 12s\tremaining: 4m 31s\n",
            "579:\tlearn: 16.7369912\ttest: 19.0959557\tbest: 19.0959412 (577)\ttotal: 6m 13s\tremaining: 4m 30s\n",
            "580:\tlearn: 16.7306819\ttest: 19.0949288\tbest: 19.0949288 (580)\ttotal: 6m 14s\tremaining: 4m 30s\n",
            "581:\tlearn: 16.7246008\ttest: 19.0870412\tbest: 19.0870412 (581)\ttotal: 6m 15s\tremaining: 4m 29s\n",
            "582:\tlearn: 16.7186464\ttest: 19.0841295\tbest: 19.0841295 (582)\ttotal: 6m 16s\tremaining: 4m 29s\n",
            "583:\tlearn: 16.7083396\ttest: 19.0793766\tbest: 19.0793766 (583)\ttotal: 6m 17s\tremaining: 4m 28s\n",
            "584:\tlearn: 16.7022261\ttest: 19.0780835\tbest: 19.0780835 (584)\ttotal: 6m 18s\tremaining: 4m 28s\n",
            "585:\tlearn: 16.6985674\ttest: 19.0752242\tbest: 19.0752242 (585)\ttotal: 6m 18s\tremaining: 4m 27s\n",
            "586:\tlearn: 16.6778026\ttest: 19.0557177\tbest: 19.0557177 (586)\ttotal: 6m 19s\tremaining: 4m 26s\n",
            "587:\tlearn: 16.6749785\ttest: 19.0522101\tbest: 19.0522101 (587)\ttotal: 6m 19s\tremaining: 4m 26s\n",
            "588:\tlearn: 16.6725671\ttest: 19.0520223\tbest: 19.0520223 (588)\ttotal: 6m 20s\tremaining: 4m 25s\n",
            "589:\tlearn: 16.6696957\ttest: 19.0492025\tbest: 19.0492025 (589)\ttotal: 6m 21s\tremaining: 4m 25s\n",
            "590:\tlearn: 16.6651573\ttest: 19.0468533\tbest: 19.0468533 (590)\ttotal: 6m 22s\tremaining: 4m 24s\n",
            "591:\tlearn: 16.6564791\ttest: 19.0393464\tbest: 19.0393464 (591)\ttotal: 6m 23s\tremaining: 4m 24s\n",
            "592:\tlearn: 16.6547512\ttest: 19.0386356\tbest: 19.0386356 (592)\ttotal: 6m 24s\tremaining: 4m 23s\n",
            "593:\tlearn: 16.6516044\ttest: 19.0380960\tbest: 19.0380960 (593)\ttotal: 6m 24s\tremaining: 4m 23s\n",
            "594:\tlearn: 16.6424587\ttest: 19.0292167\tbest: 19.0292167 (594)\ttotal: 6m 25s\tremaining: 4m 22s\n",
            "595:\tlearn: 16.6392696\ttest: 19.0293311\tbest: 19.0292167 (594)\ttotal: 6m 26s\tremaining: 4m 21s\n",
            "596:\tlearn: 16.6355966\ttest: 19.0278370\tbest: 19.0278370 (596)\ttotal: 6m 26s\tremaining: 4m 20s\n",
            "597:\tlearn: 16.6322200\ttest: 19.0256216\tbest: 19.0256216 (597)\ttotal: 6m 27s\tremaining: 4m 20s\n",
            "598:\tlearn: 16.6287774\ttest: 19.0212671\tbest: 19.0212671 (598)\ttotal: 6m 27s\tremaining: 4m 19s\n",
            "599:\tlearn: 16.6237728\ttest: 19.0176859\tbest: 19.0176859 (599)\ttotal: 6m 28s\tremaining: 4m 19s\n",
            "600:\tlearn: 16.6219367\ttest: 19.0179386\tbest: 19.0176859 (599)\ttotal: 6m 29s\tremaining: 4m 18s\n",
            "601:\tlearn: 16.6128813\ttest: 19.0062522\tbest: 19.0062522 (601)\ttotal: 6m 30s\tremaining: 4m 18s\n",
            "602:\tlearn: 16.6094253\ttest: 19.0069518\tbest: 19.0062522 (601)\ttotal: 6m 31s\tremaining: 4m 17s\n",
            "603:\tlearn: 16.6076222\ttest: 19.0065474\tbest: 19.0062522 (601)\ttotal: 6m 32s\tremaining: 4m 17s\n",
            "604:\tlearn: 16.6030523\ttest: 19.0011781\tbest: 19.0011781 (604)\ttotal: 6m 32s\tremaining: 4m 16s\n",
            "605:\tlearn: 16.5957300\ttest: 18.9978453\tbest: 18.9978453 (605)\ttotal: 6m 33s\tremaining: 4m 15s\n",
            "606:\tlearn: 16.5849203\ttest: 18.9914130\tbest: 18.9914130 (606)\ttotal: 6m 34s\tremaining: 4m 15s\n",
            "607:\tlearn: 16.5656554\ttest: 18.9694091\tbest: 18.9694091 (607)\ttotal: 6m 34s\tremaining: 4m 14s\n",
            "608:\tlearn: 16.5591998\ttest: 18.9648968\tbest: 18.9648968 (608)\ttotal: 6m 35s\tremaining: 4m 13s\n",
            "609:\tlearn: 16.5570933\ttest: 18.9637477\tbest: 18.9637477 (609)\ttotal: 6m 36s\tremaining: 4m 13s\n",
            "610:\tlearn: 16.5545615\ttest: 18.9653591\tbest: 18.9637477 (609)\ttotal: 6m 36s\tremaining: 4m 12s\n",
            "611:\tlearn: 16.5450862\ttest: 18.9592256\tbest: 18.9592256 (611)\ttotal: 6m 37s\tremaining: 4m 11s\n",
            "612:\tlearn: 16.5266635\ttest: 18.9465060\tbest: 18.9465060 (612)\ttotal: 6m 37s\tremaining: 4m 11s\n",
            "613:\tlearn: 16.5214313\ttest: 18.9444691\tbest: 18.9444691 (613)\ttotal: 6m 38s\tremaining: 4m 10s\n",
            "614:\tlearn: 16.5061627\ttest: 18.9135581\tbest: 18.9135581 (614)\ttotal: 6m 38s\tremaining: 4m 9s\n",
            "615:\tlearn: 16.4957603\ttest: 18.8867524\tbest: 18.8867524 (615)\ttotal: 6m 39s\tremaining: 4m 8s\n",
            "616:\tlearn: 16.4851648\ttest: 18.8749470\tbest: 18.8749470 (616)\ttotal: 6m 39s\tremaining: 4m 8s\n",
            "617:\tlearn: 16.4829938\ttest: 18.8742163\tbest: 18.8742163 (617)\ttotal: 6m 40s\tremaining: 4m 7s\n",
            "618:\tlearn: 16.4801126\ttest: 18.8721090\tbest: 18.8721090 (618)\ttotal: 6m 41s\tremaining: 4m 6s\n",
            "619:\tlearn: 16.4714312\ttest: 18.8639261\tbest: 18.8639261 (619)\ttotal: 6m 41s\tremaining: 4m 6s\n",
            "620:\tlearn: 16.4615876\ttest: 18.8543944\tbest: 18.8543944 (620)\ttotal: 6m 42s\tremaining: 4m 5s\n",
            "621:\tlearn: 16.4592844\ttest: 18.8527323\tbest: 18.8527323 (621)\ttotal: 6m 43s\tremaining: 4m 4s\n",
            "622:\tlearn: 16.4552071\ttest: 18.8497153\tbest: 18.8497153 (622)\ttotal: 6m 44s\tremaining: 4m 4s\n",
            "623:\tlearn: 16.4518793\ttest: 18.8466968\tbest: 18.8466968 (623)\ttotal: 6m 45s\tremaining: 4m 4s\n",
            "624:\tlearn: 16.4458743\ttest: 18.8431508\tbest: 18.8431508 (624)\ttotal: 6m 46s\tremaining: 4m 3s\n",
            "625:\tlearn: 16.4442047\ttest: 18.8427725\tbest: 18.8427725 (625)\ttotal: 6m 46s\tremaining: 4m 2s\n",
            "626:\tlearn: 16.4406302\ttest: 18.8404661\tbest: 18.8404661 (626)\ttotal: 6m 47s\tremaining: 4m 2s\n",
            "627:\tlearn: 16.4330199\ttest: 18.8348035\tbest: 18.8348035 (627)\ttotal: 6m 47s\tremaining: 4m 1s\n",
            "628:\tlearn: 16.4308647\ttest: 18.8339271\tbest: 18.8339271 (628)\ttotal: 6m 48s\tremaining: 4m\n",
            "629:\tlearn: 16.4255385\ttest: 18.8320292\tbest: 18.8320292 (629)\ttotal: 6m 48s\tremaining: 4m\n",
            "630:\tlearn: 16.4161545\ttest: 18.8224844\tbest: 18.8224844 (630)\ttotal: 6m 49s\tremaining: 3m 59s\n",
            "631:\tlearn: 16.4133296\ttest: 18.8224724\tbest: 18.8224724 (631)\ttotal: 6m 50s\tremaining: 3m 58s\n",
            "632:\tlearn: 16.3941366\ttest: 18.8141045\tbest: 18.8141045 (632)\ttotal: 6m 50s\tremaining: 3m 58s\n",
            "633:\tlearn: 16.3911427\ttest: 18.8134723\tbest: 18.8134723 (633)\ttotal: 6m 51s\tremaining: 3m 57s\n",
            "634:\tlearn: 16.3807016\ttest: 18.8045642\tbest: 18.8045642 (634)\ttotal: 6m 52s\tremaining: 3m 56s\n",
            "635:\tlearn: 16.3780585\ttest: 18.8050146\tbest: 18.8045642 (634)\ttotal: 6m 52s\tremaining: 3m 56s\n",
            "636:\tlearn: 16.3747037\ttest: 18.8024867\tbest: 18.8024867 (636)\ttotal: 6m 53s\tremaining: 3m 55s\n",
            "637:\tlearn: 16.3629517\ttest: 18.7941334\tbest: 18.7941334 (637)\ttotal: 6m 53s\tremaining: 3m 54s\n",
            "638:\tlearn: 16.3472322\ttest: 18.7822296\tbest: 18.7822296 (638)\ttotal: 6m 54s\tremaining: 3m 53s\n",
            "639:\tlearn: 16.3454269\ttest: 18.7808978\tbest: 18.7808978 (639)\ttotal: 6m 54s\tremaining: 3m 53s\n",
            "640:\tlearn: 16.3407555\ttest: 18.7767928\tbest: 18.7767928 (640)\ttotal: 6m 55s\tremaining: 3m 52s\n",
            "641:\tlearn: 16.3342403\ttest: 18.7743597\tbest: 18.7743597 (641)\ttotal: 6m 55s\tremaining: 3m 51s\n",
            "642:\tlearn: 16.3254046\ttest: 18.7693913\tbest: 18.7693913 (642)\ttotal: 6m 56s\tremaining: 3m 50s\n",
            "643:\tlearn: 16.3175406\ttest: 18.7630686\tbest: 18.7630686 (643)\ttotal: 6m 56s\tremaining: 3m 50s\n",
            "644:\tlearn: 16.3032743\ttest: 18.7546035\tbest: 18.7546035 (644)\ttotal: 6m 57s\tremaining: 3m 49s\n",
            "645:\tlearn: 16.2984718\ttest: 18.7497689\tbest: 18.7497689 (645)\ttotal: 6m 58s\tremaining: 3m 49s\n",
            "646:\tlearn: 16.2917905\ttest: 18.7428068\tbest: 18.7428068 (646)\ttotal: 6m 59s\tremaining: 3m 48s\n",
            "647:\tlearn: 16.2778094\ttest: 18.7317511\tbest: 18.7317511 (647)\ttotal: 7m\tremaining: 3m 48s\n",
            "648:\tlearn: 16.2724985\ttest: 18.7280240\tbest: 18.7280240 (648)\ttotal: 7m 1s\tremaining: 3m 47s\n",
            "649:\tlearn: 16.2705636\ttest: 18.7273833\tbest: 18.7273833 (649)\ttotal: 7m 1s\tremaining: 3m 47s\n",
            "650:\tlearn: 16.2676597\ttest: 18.7273735\tbest: 18.7273735 (650)\ttotal: 7m 2s\tremaining: 3m 46s\n",
            "651:\tlearn: 16.2649602\ttest: 18.7263228\tbest: 18.7263228 (651)\ttotal: 7m 2s\tremaining: 3m 45s\n",
            "652:\tlearn: 16.2571767\ttest: 18.7176828\tbest: 18.7176828 (652)\ttotal: 7m 3s\tremaining: 3m 44s\n",
            "653:\tlearn: 16.2488604\ttest: 18.7161305\tbest: 18.7161305 (653)\ttotal: 7m 3s\tremaining: 3m 44s\n",
            "654:\tlearn: 16.2439344\ttest: 18.7164382\tbest: 18.7161305 (653)\ttotal: 7m 4s\tremaining: 3m 43s\n",
            "655:\tlearn: 16.2340286\ttest: 18.7118948\tbest: 18.7118948 (655)\ttotal: 7m 5s\tremaining: 3m 42s\n",
            "656:\tlearn: 16.2264550\ttest: 18.7025030\tbest: 18.7025030 (656)\ttotal: 7m 5s\tremaining: 3m 42s\n",
            "657:\tlearn: 16.2211386\ttest: 18.7018930\tbest: 18.7018930 (657)\ttotal: 7m 6s\tremaining: 3m 41s\n",
            "658:\tlearn: 16.2184198\ttest: 18.7014510\tbest: 18.7014510 (658)\ttotal: 7m 6s\tremaining: 3m 40s\n",
            "659:\tlearn: 16.2115127\ttest: 18.6961043\tbest: 18.6961043 (659)\ttotal: 7m 7s\tremaining: 3m 40s\n",
            "660:\tlearn: 16.2088535\ttest: 18.6942690\tbest: 18.6942690 (660)\ttotal: 7m 7s\tremaining: 3m 39s\n",
            "661:\tlearn: 16.2031885\ttest: 18.6906079\tbest: 18.6906079 (661)\ttotal: 7m 8s\tremaining: 3m 38s\n",
            "662:\tlearn: 16.2009827\ttest: 18.6899553\tbest: 18.6899553 (662)\ttotal: 7m 9s\tremaining: 3m 38s\n",
            "663:\tlearn: 16.1958545\ttest: 18.6865781\tbest: 18.6865781 (663)\ttotal: 7m 9s\tremaining: 3m 37s\n",
            "664:\tlearn: 16.1908218\ttest: 18.6814744\tbest: 18.6814744 (664)\ttotal: 7m 10s\tremaining: 3m 36s\n",
            "665:\tlearn: 16.1866663\ttest: 18.6771889\tbest: 18.6771889 (665)\ttotal: 7m 10s\tremaining: 3m 36s\n",
            "666:\tlearn: 16.1816908\ttest: 18.6759401\tbest: 18.6759401 (666)\ttotal: 7m 11s\tremaining: 3m 35s\n",
            "667:\tlearn: 16.1729809\ttest: 18.6689759\tbest: 18.6689759 (667)\ttotal: 7m 12s\tremaining: 3m 35s\n",
            "668:\tlearn: 16.1665664\ttest: 18.6643325\tbest: 18.6643325 (668)\ttotal: 7m 13s\tremaining: 3m 34s\n",
            "669:\tlearn: 16.1626724\ttest: 18.6617196\tbest: 18.6617196 (669)\ttotal: 7m 14s\tremaining: 3m 33s\n",
            "670:\tlearn: 16.1613379\ttest: 18.6611551\tbest: 18.6611551 (670)\ttotal: 7m 15s\tremaining: 3m 33s\n",
            "671:\tlearn: 16.1606838\ttest: 18.6612422\tbest: 18.6611551 (670)\ttotal: 7m 15s\tremaining: 3m 32s\n",
            "672:\tlearn: 16.1551357\ttest: 18.6584597\tbest: 18.6584597 (672)\ttotal: 7m 16s\tremaining: 3m 32s\n",
            "673:\tlearn: 16.1503086\ttest: 18.6590904\tbest: 18.6584597 (672)\ttotal: 7m 16s\tremaining: 3m 31s\n",
            "674:\tlearn: 16.1473991\ttest: 18.6581754\tbest: 18.6581754 (674)\ttotal: 7m 17s\tremaining: 3m 30s\n",
            "675:\tlearn: 16.1424485\ttest: 18.6567844\tbest: 18.6567844 (675)\ttotal: 7m 18s\tremaining: 3m 29s\n",
            "676:\tlearn: 16.1410121\ttest: 18.6556888\tbest: 18.6556888 (676)\ttotal: 7m 18s\tremaining: 3m 29s\n",
            "677:\tlearn: 16.1359305\ttest: 18.6580146\tbest: 18.6556888 (676)\ttotal: 7m 19s\tremaining: 3m 28s\n",
            "678:\tlearn: 16.1307687\ttest: 18.6531232\tbest: 18.6531232 (678)\ttotal: 7m 19s\tremaining: 3m 27s\n",
            "679:\tlearn: 16.1247509\ttest: 18.6491463\tbest: 18.6491463 (679)\ttotal: 7m 20s\tremaining: 3m 27s\n",
            "680:\tlearn: 16.1197921\ttest: 18.6485193\tbest: 18.6485193 (680)\ttotal: 7m 20s\tremaining: 3m 26s\n",
            "681:\tlearn: 16.1168184\ttest: 18.6461132\tbest: 18.6461132 (681)\ttotal: 7m 21s\tremaining: 3m 25s\n",
            "682:\tlearn: 16.1143750\ttest: 18.6462059\tbest: 18.6461132 (681)\ttotal: 7m 21s\tremaining: 3m 25s\n",
            "683:\tlearn: 16.1011438\ttest: 18.6283915\tbest: 18.6283915 (683)\ttotal: 7m 22s\tremaining: 3m 24s\n",
            "684:\tlearn: 16.0939484\ttest: 18.6229418\tbest: 18.6229418 (684)\ttotal: 7m 23s\tremaining: 3m 23s\n",
            "685:\tlearn: 16.0903160\ttest: 18.6215685\tbest: 18.6215685 (685)\ttotal: 7m 23s\tremaining: 3m 23s\n",
            "686:\tlearn: 16.0846536\ttest: 18.6197846\tbest: 18.6197846 (686)\ttotal: 7m 24s\tremaining: 3m 22s\n",
            "687:\tlearn: 16.0723542\ttest: 18.6040051\tbest: 18.6040051 (687)\ttotal: 7m 24s\tremaining: 3m 21s\n",
            "688:\tlearn: 16.0709443\ttest: 18.6041661\tbest: 18.6040051 (687)\ttotal: 7m 25s\tremaining: 3m 21s\n",
            "689:\tlearn: 16.0661861\ttest: 18.6010283\tbest: 18.6010283 (689)\ttotal: 7m 26s\tremaining: 3m 20s\n",
            "690:\tlearn: 16.0590636\ttest: 18.5943136\tbest: 18.5943136 (690)\ttotal: 7m 27s\tremaining: 3m 20s\n",
            "691:\tlearn: 16.0570012\ttest: 18.5935790\tbest: 18.5935790 (691)\ttotal: 7m 28s\tremaining: 3m 19s\n",
            "692:\tlearn: 16.0519343\ttest: 18.5895720\tbest: 18.5895720 (692)\ttotal: 7m 29s\tremaining: 3m 19s\n",
            "693:\tlearn: 16.0429707\ttest: 18.5819063\tbest: 18.5819063 (693)\ttotal: 7m 30s\tremaining: 3m 18s\n",
            "694:\tlearn: 16.0316083\ttest: 18.5724052\tbest: 18.5724052 (694)\ttotal: 7m 30s\tremaining: 3m 17s\n",
            "695:\tlearn: 16.0238330\ttest: 18.5669073\tbest: 18.5669073 (695)\ttotal: 7m 31s\tremaining: 3m 17s\n",
            "696:\tlearn: 16.0206108\ttest: 18.5634375\tbest: 18.5634375 (696)\ttotal: 7m 31s\tremaining: 3m 16s\n",
            "697:\tlearn: 16.0189105\ttest: 18.5633366\tbest: 18.5633366 (697)\ttotal: 7m 32s\tremaining: 3m 15s\n",
            "698:\tlearn: 16.0170846\ttest: 18.5620099\tbest: 18.5620099 (698)\ttotal: 7m 32s\tremaining: 3m 15s\n",
            "699:\tlearn: 16.0159521\ttest: 18.5613891\tbest: 18.5613891 (699)\ttotal: 7m 33s\tremaining: 3m 14s\n",
            "700:\tlearn: 16.0102784\ttest: 18.5570912\tbest: 18.5570912 (700)\ttotal: 7m 34s\tremaining: 3m 13s\n",
            "701:\tlearn: 16.0096297\ttest: 18.5574453\tbest: 18.5570912 (700)\ttotal: 7m 34s\tremaining: 3m 13s\n",
            "702:\tlearn: 16.0021596\ttest: 18.5521953\tbest: 18.5521953 (702)\ttotal: 7m 35s\tremaining: 3m 12s\n",
            "703:\tlearn: 16.0000263\ttest: 18.5518639\tbest: 18.5518639 (703)\ttotal: 7m 36s\tremaining: 3m 11s\n",
            "704:\tlearn: 15.9959884\ttest: 18.5476446\tbest: 18.5476446 (704)\ttotal: 7m 36s\tremaining: 3m 11s\n",
            "705:\tlearn: 15.9891635\ttest: 18.5428371\tbest: 18.5428371 (705)\ttotal: 7m 37s\tremaining: 3m 10s\n",
            "706:\tlearn: 15.9866144\ttest: 18.5420534\tbest: 18.5420534 (706)\ttotal: 7m 37s\tremaining: 3m 9s\n",
            "707:\tlearn: 15.9813243\ttest: 18.5410443\tbest: 18.5410443 (707)\ttotal: 7m 38s\tremaining: 3m 9s\n",
            "708:\tlearn: 15.9748303\ttest: 18.5348853\tbest: 18.5348853 (708)\ttotal: 7m 38s\tremaining: 3m 8s\n",
            "709:\tlearn: 15.9679199\ttest: 18.5321622\tbest: 18.5321622 (709)\ttotal: 7m 39s\tremaining: 3m 7s\n",
            "710:\tlearn: 15.9657703\ttest: 18.5314887\tbest: 18.5314887 (710)\ttotal: 7m 40s\tremaining: 3m 7s\n",
            "711:\tlearn: 15.9608099\ttest: 18.5308978\tbest: 18.5308978 (711)\ttotal: 7m 41s\tremaining: 3m 6s\n",
            "712:\tlearn: 15.9528019\ttest: 18.5240916\tbest: 18.5240916 (712)\ttotal: 7m 42s\tremaining: 3m 6s\n",
            "713:\tlearn: 15.9504249\ttest: 18.5217832\tbest: 18.5217832 (713)\ttotal: 7m 43s\tremaining: 3m 5s\n",
            "714:\tlearn: 15.9466345\ttest: 18.5188513\tbest: 18.5188513 (714)\ttotal: 7m 44s\tremaining: 3m 5s\n",
            "715:\tlearn: 15.9418583\ttest: 18.5184755\tbest: 18.5184755 (715)\ttotal: 7m 44s\tremaining: 3m 4s\n",
            "716:\tlearn: 15.9391059\ttest: 18.5166307\tbest: 18.5166307 (716)\ttotal: 7m 45s\tremaining: 3m 3s\n",
            "717:\tlearn: 15.9339641\ttest: 18.5156371\tbest: 18.5156371 (717)\ttotal: 7m 46s\tremaining: 3m 3s\n",
            "718:\tlearn: 15.9284458\ttest: 18.5126886\tbest: 18.5126886 (718)\ttotal: 7m 46s\tremaining: 3m 2s\n",
            "719:\tlearn: 15.9260725\ttest: 18.5120698\tbest: 18.5120698 (719)\ttotal: 7m 47s\tremaining: 3m 1s\n",
            "720:\tlearn: 15.9246400\ttest: 18.5118290\tbest: 18.5118290 (720)\ttotal: 7m 47s\tremaining: 3m 1s\n",
            "721:\tlearn: 15.9235995\ttest: 18.5116591\tbest: 18.5116591 (721)\ttotal: 7m 48s\tremaining: 3m\n",
            "722:\tlearn: 15.9168520\ttest: 18.5030606\tbest: 18.5030606 (722)\ttotal: 7m 49s\tremaining: 2m 59s\n",
            "723:\tlearn: 15.9125117\ttest: 18.5011256\tbest: 18.5011256 (723)\ttotal: 7m 49s\tremaining: 2m 59s\n",
            "724:\tlearn: 15.9086133\ttest: 18.5007993\tbest: 18.5007993 (724)\ttotal: 7m 50s\tremaining: 2m 58s\n",
            "725:\tlearn: 15.9056737\ttest: 18.5011847\tbest: 18.5007993 (724)\ttotal: 7m 50s\tremaining: 2m 57s\n",
            "726:\tlearn: 15.9032334\ttest: 18.5002566\tbest: 18.5002566 (726)\ttotal: 7m 51s\tremaining: 2m 57s\n",
            "727:\tlearn: 15.9028004\ttest: 18.5003250\tbest: 18.5002566 (726)\ttotal: 7m 52s\tremaining: 2m 56s\n",
            "728:\tlearn: 15.8984165\ttest: 18.4998115\tbest: 18.4998115 (728)\ttotal: 7m 52s\tremaining: 2m 55s\n",
            "729:\tlearn: 15.8963915\ttest: 18.4987329\tbest: 18.4987329 (729)\ttotal: 7m 53s\tremaining: 2m 54s\n",
            "730:\tlearn: 15.8883791\ttest: 18.4938371\tbest: 18.4938371 (730)\ttotal: 7m 53s\tremaining: 2m 54s\n",
            "731:\tlearn: 15.8848787\ttest: 18.4897277\tbest: 18.4897277 (731)\ttotal: 7m 54s\tremaining: 2m 53s\n",
            "732:\tlearn: 15.8824117\ttest: 18.4904338\tbest: 18.4897277 (731)\ttotal: 7m 55s\tremaining: 2m 53s\n",
            "733:\tlearn: 15.8757929\ttest: 18.4930100\tbest: 18.4897277 (731)\ttotal: 7m 56s\tremaining: 2m 52s\n",
            "734:\tlearn: 15.8730798\ttest: 18.4895421\tbest: 18.4895421 (734)\ttotal: 7m 57s\tremaining: 2m 52s\n",
            "735:\tlearn: 15.8716610\ttest: 18.4884164\tbest: 18.4884164 (735)\ttotal: 7m 58s\tremaining: 2m 51s\n",
            "736:\tlearn: 15.8698525\ttest: 18.4863979\tbest: 18.4863979 (736)\ttotal: 7m 58s\tremaining: 2m 50s\n",
            "737:\tlearn: 15.8626491\ttest: 18.4792189\tbest: 18.4792189 (737)\ttotal: 7m 59s\tremaining: 2m 50s\n",
            "738:\tlearn: 15.8617287\ttest: 18.4787494\tbest: 18.4787494 (738)\ttotal: 8m\tremaining: 2m 49s\n",
            "739:\tlearn: 15.8589871\ttest: 18.4773332\tbest: 18.4773332 (739)\ttotal: 8m\tremaining: 2m 48s\n",
            "740:\tlearn: 15.8542726\ttest: 18.4759668\tbest: 18.4759668 (740)\ttotal: 8m 1s\tremaining: 2m 48s\n",
            "741:\tlearn: 15.8497836\ttest: 18.4745411\tbest: 18.4745411 (741)\ttotal: 8m 1s\tremaining: 2m 47s\n",
            "742:\tlearn: 15.8488703\ttest: 18.4741655\tbest: 18.4741655 (742)\ttotal: 8m 2s\tremaining: 2m 46s\n",
            "743:\tlearn: 15.8484142\ttest: 18.4741638\tbest: 18.4741638 (743)\ttotal: 8m 2s\tremaining: 2m 46s\n",
            "744:\tlearn: 15.8449120\ttest: 18.4733377\tbest: 18.4733377 (744)\ttotal: 8m 3s\tremaining: 2m 45s\n",
            "745:\tlearn: 15.8409835\ttest: 18.4702537\tbest: 18.4702537 (745)\ttotal: 8m 4s\tremaining: 2m 44s\n",
            "746:\tlearn: 15.8349083\ttest: 18.4654784\tbest: 18.4654784 (746)\ttotal: 8m 4s\tremaining: 2m 44s\n",
            "747:\tlearn: 15.8339043\ttest: 18.4635564\tbest: 18.4635564 (747)\ttotal: 8m 5s\tremaining: 2m 43s\n",
            "748:\tlearn: 15.8289957\ttest: 18.4597484\tbest: 18.4597484 (748)\ttotal: 8m 6s\tremaining: 2m 42s\n",
            "749:\tlearn: 15.8233593\ttest: 18.4563079\tbest: 18.4563079 (749)\ttotal: 8m 6s\tremaining: 2m 42s\n",
            "750:\tlearn: 15.8180425\ttest: 18.4349824\tbest: 18.4349824 (750)\ttotal: 8m 7s\tremaining: 2m 41s\n",
            "751:\tlearn: 15.8163505\ttest: 18.4321495\tbest: 18.4321495 (751)\ttotal: 8m 7s\tremaining: 2m 40s\n",
            "752:\tlearn: 15.8150350\ttest: 18.4320175\tbest: 18.4320175 (752)\ttotal: 8m 8s\tremaining: 2m 40s\n",
            "753:\tlearn: 15.8117850\ttest: 18.4310226\tbest: 18.4310226 (753)\ttotal: 8m 8s\tremaining: 2m 39s\n",
            "754:\tlearn: 15.8086640\ttest: 18.4302824\tbest: 18.4302824 (754)\ttotal: 8m 9s\tremaining: 2m 38s\n",
            "755:\tlearn: 15.8045508\ttest: 18.4298549\tbest: 18.4298549 (755)\ttotal: 8m 10s\tremaining: 2m 38s\n",
            "756:\tlearn: 15.7850204\ttest: 18.3824601\tbest: 18.3824601 (756)\ttotal: 8m 12s\tremaining: 2m 37s\n",
            "757:\tlearn: 15.7840332\ttest: 18.3825199\tbest: 18.3824601 (756)\ttotal: 8m 12s\tremaining: 2m 37s\n",
            "758:\tlearn: 15.7810606\ttest: 18.3813495\tbest: 18.3813495 (758)\ttotal: 8m 13s\tremaining: 2m 36s\n",
            "759:\tlearn: 15.7792713\ttest: 18.3798640\tbest: 18.3798640 (759)\ttotal: 8m 14s\tremaining: 2m 36s\n",
            "760:\tlearn: 15.7764511\ttest: 18.3798510\tbest: 18.3798510 (760)\ttotal: 8m 14s\tremaining: 2m 35s\n",
            "761:\tlearn: 15.7719774\ttest: 18.3803991\tbest: 18.3798510 (760)\ttotal: 8m 15s\tremaining: 2m 34s\n",
            "762:\tlearn: 15.7673293\ttest: 18.3839437\tbest: 18.3798510 (760)\ttotal: 8m 15s\tremaining: 2m 34s\n",
            "763:\tlearn: 15.7665534\ttest: 18.3838412\tbest: 18.3798510 (760)\ttotal: 8m 16s\tremaining: 2m 33s\n",
            "764:\tlearn: 15.7641440\ttest: 18.3846820\tbest: 18.3798510 (760)\ttotal: 8m 17s\tremaining: 2m 32s\n",
            "765:\tlearn: 15.7604857\ttest: 18.3825543\tbest: 18.3798510 (760)\ttotal: 8m 17s\tremaining: 2m 32s\n",
            "766:\tlearn: 15.7576134\ttest: 18.3819940\tbest: 18.3798510 (760)\ttotal: 8m 18s\tremaining: 2m 31s\n",
            "767:\tlearn: 15.7538410\ttest: 18.3681379\tbest: 18.3681379 (767)\ttotal: 8m 18s\tremaining: 2m 30s\n",
            "768:\tlearn: 15.7506174\ttest: 18.3655932\tbest: 18.3655932 (768)\ttotal: 8m 19s\tremaining: 2m 30s\n",
            "769:\tlearn: 15.7495359\ttest: 18.3657280\tbest: 18.3655932 (768)\ttotal: 8m 20s\tremaining: 2m 29s\n",
            "770:\tlearn: 15.7442175\ttest: 18.3663066\tbest: 18.3655932 (768)\ttotal: 8m 20s\tremaining: 2m 28s\n",
            "771:\tlearn: 15.7328412\ttest: 18.3427546\tbest: 18.3427546 (771)\ttotal: 8m 21s\tremaining: 2m 28s\n",
            "772:\tlearn: 15.7312900\ttest: 18.3428690\tbest: 18.3427546 (771)\ttotal: 8m 21s\tremaining: 2m 27s\n",
            "773:\tlearn: 15.7288843\ttest: 18.3405433\tbest: 18.3405433 (773)\ttotal: 8m 22s\tremaining: 2m 26s\n",
            "774:\tlearn: 15.7259480\ttest: 18.3390839\tbest: 18.3390839 (774)\ttotal: 8m 23s\tremaining: 2m 26s\n",
            "775:\tlearn: 15.7248360\ttest: 18.3398450\tbest: 18.3390839 (774)\ttotal: 8m 24s\tremaining: 2m 25s\n",
            "776:\tlearn: 15.7231194\ttest: 18.3386234\tbest: 18.3386234 (776)\ttotal: 8m 25s\tremaining: 2m 24s\n",
            "777:\tlearn: 15.7225039\ttest: 18.3390407\tbest: 18.3386234 (776)\ttotal: 8m 26s\tremaining: 2m 24s\n",
            "778:\tlearn: 15.7210643\ttest: 18.3388098\tbest: 18.3386234 (776)\ttotal: 8m 27s\tremaining: 2m 23s\n",
            "779:\tlearn: 15.7167431\ttest: 18.3315730\tbest: 18.3315730 (779)\ttotal: 8m 27s\tremaining: 2m 23s\n",
            "780:\tlearn: 15.7131263\ttest: 18.3294921\tbest: 18.3294921 (780)\ttotal: 8m 28s\tremaining: 2m 22s\n",
            "781:\tlearn: 15.7019272\ttest: 18.3238809\tbest: 18.3238809 (781)\ttotal: 8m 29s\tremaining: 2m 21s\n",
            "782:\tlearn: 15.7005261\ttest: 18.3218826\tbest: 18.3218826 (782)\ttotal: 8m 29s\tremaining: 2m 21s\n",
            "783:\tlearn: 15.6975571\ttest: 18.3212403\tbest: 18.3212403 (783)\ttotal: 8m 30s\tremaining: 2m 20s\n",
            "784:\tlearn: 15.6958651\ttest: 18.3195989\tbest: 18.3195989 (784)\ttotal: 8m 30s\tremaining: 2m 19s\n",
            "785:\tlearn: 15.6917977\ttest: 18.3172114\tbest: 18.3172114 (785)\ttotal: 8m 31s\tremaining: 2m 19s\n",
            "786:\tlearn: 15.6891008\ttest: 18.3157905\tbest: 18.3157905 (786)\ttotal: 8m 31s\tremaining: 2m 18s\n",
            "787:\tlearn: 15.6880437\ttest: 18.3161104\tbest: 18.3157905 (786)\ttotal: 8m 32s\tremaining: 2m 17s\n",
            "788:\tlearn: 15.6876479\ttest: 18.3160956\tbest: 18.3157905 (786)\ttotal: 8m 33s\tremaining: 2m 17s\n",
            "789:\tlearn: 15.6856738\ttest: 18.3165010\tbest: 18.3157905 (786)\ttotal: 8m 33s\tremaining: 2m 16s\n",
            "790:\tlearn: 15.6783284\ttest: 18.3089952\tbest: 18.3089952 (790)\ttotal: 8m 34s\tremaining: 2m 15s\n",
            "791:\tlearn: 15.6756273\ttest: 18.3108161\tbest: 18.3089952 (790)\ttotal: 8m 34s\tremaining: 2m 15s\n",
            "792:\tlearn: 15.6729048\ttest: 18.3094525\tbest: 18.3089952 (790)\ttotal: 8m 35s\tremaining: 2m 14s\n",
            "793:\tlearn: 15.6682055\ttest: 18.3047018\tbest: 18.3047018 (793)\ttotal: 8m 35s\tremaining: 2m 13s\n",
            "794:\tlearn: 15.6608613\ttest: 18.3074321\tbest: 18.3047018 (793)\ttotal: 8m 36s\tremaining: 2m 13s\n",
            "795:\tlearn: 15.6572748\ttest: 18.3058624\tbest: 18.3047018 (793)\ttotal: 8m 36s\tremaining: 2m 12s\n",
            "796:\tlearn: 15.6549594\ttest: 18.3043878\tbest: 18.3043878 (796)\ttotal: 8m 37s\tremaining: 2m 11s\n",
            "797:\tlearn: 15.6542468\ttest: 18.3043422\tbest: 18.3043422 (797)\ttotal: 8m 38s\tremaining: 2m 11s\n",
            "798:\tlearn: 15.6510521\ttest: 18.3026588\tbest: 18.3026588 (798)\ttotal: 8m 39s\tremaining: 2m 10s\n",
            "799:\tlearn: 15.6496221\ttest: 18.3036027\tbest: 18.3026588 (798)\ttotal: 8m 40s\tremaining: 2m 10s\n",
            "800:\tlearn: 15.6447982\ttest: 18.2969110\tbest: 18.2969110 (800)\ttotal: 8m 41s\tremaining: 2m 9s\n",
            "801:\tlearn: 15.6404175\ttest: 18.2923466\tbest: 18.2923466 (801)\ttotal: 8m 42s\tremaining: 2m 8s\n",
            "802:\tlearn: 15.6339562\ttest: 18.2932438\tbest: 18.2923466 (801)\ttotal: 8m 43s\tremaining: 2m 8s\n",
            "803:\tlearn: 15.6305374\ttest: 18.2870173\tbest: 18.2870173 (803)\ttotal: 8m 43s\tremaining: 2m 7s\n",
            "804:\tlearn: 15.6269643\ttest: 18.2877204\tbest: 18.2870173 (803)\ttotal: 8m 44s\tremaining: 2m 6s\n",
            "805:\tlearn: 15.6221589\ttest: 18.2836691\tbest: 18.2836691 (805)\ttotal: 8m 44s\tremaining: 2m 6s\n",
            "806:\tlearn: 15.6151486\ttest: 18.2776953\tbest: 18.2776953 (806)\ttotal: 8m 45s\tremaining: 2m 5s\n",
            "807:\tlearn: 15.6123784\ttest: 18.2770505\tbest: 18.2770505 (807)\ttotal: 8m 45s\tremaining: 2m 4s\n",
            "808:\tlearn: 15.6085736\ttest: 18.2731586\tbest: 18.2731586 (808)\ttotal: 8m 46s\tremaining: 2m 4s\n",
            "809:\tlearn: 15.6056429\ttest: 18.2738532\tbest: 18.2731586 (808)\ttotal: 8m 47s\tremaining: 2m 3s\n",
            "810:\tlearn: 15.6033689\ttest: 18.2737706\tbest: 18.2731586 (808)\ttotal: 8m 47s\tremaining: 2m 2s\n",
            "811:\tlearn: 15.5996145\ttest: 18.2699316\tbest: 18.2699316 (811)\ttotal: 8m 48s\tremaining: 2m 2s\n",
            "812:\tlearn: 15.5962863\ttest: 18.2691370\tbest: 18.2691370 (812)\ttotal: 8m 48s\tremaining: 2m 1s\n",
            "813:\tlearn: 15.5956099\ttest: 18.2691378\tbest: 18.2691370 (812)\ttotal: 8m 49s\tremaining: 2m\n",
            "814:\tlearn: 15.5928243\ttest: 18.2661829\tbest: 18.2661829 (814)\ttotal: 8m 49s\tremaining: 2m\n",
            "815:\tlearn: 15.5920606\ttest: 18.2653851\tbest: 18.2653851 (815)\ttotal: 8m 50s\tremaining: 1m 59s\n",
            "816:\tlearn: 15.5867887\ttest: 18.2614939\tbest: 18.2614939 (816)\ttotal: 8m 51s\tremaining: 1m 58s\n",
            "817:\tlearn: 15.5847622\ttest: 18.2623214\tbest: 18.2614939 (816)\ttotal: 8m 51s\tremaining: 1m 58s\n",
            "818:\tlearn: 15.5802338\ttest: 18.2622211\tbest: 18.2614939 (816)\ttotal: 8m 52s\tremaining: 1m 57s\n",
            "819:\tlearn: 15.5773680\ttest: 18.2621739\tbest: 18.2614939 (816)\ttotal: 8m 53s\tremaining: 1m 57s\n",
            "820:\tlearn: 15.5758370\ttest: 18.2614073\tbest: 18.2614073 (820)\ttotal: 8m 54s\tremaining: 1m 56s\n",
            "821:\tlearn: 15.5670935\ttest: 18.2528829\tbest: 18.2528829 (821)\ttotal: 8m 55s\tremaining: 1m 56s\n",
            "822:\tlearn: 15.5657855\ttest: 18.2523662\tbest: 18.2523662 (822)\ttotal: 8m 56s\tremaining: 1m 55s\n",
            "823:\tlearn: 15.5614623\ttest: 18.2490438\tbest: 18.2490438 (823)\ttotal: 8m 56s\tremaining: 1m 54s\n",
            "824:\tlearn: 15.5606507\ttest: 18.2493107\tbest: 18.2490438 (823)\ttotal: 8m 57s\tremaining: 1m 54s\n",
            "825:\tlearn: 15.5562840\ttest: 18.2486554\tbest: 18.2486554 (825)\ttotal: 8m 58s\tremaining: 1m 53s\n",
            "826:\tlearn: 15.5518644\ttest: 18.2444502\tbest: 18.2444502 (826)\ttotal: 8m 58s\tremaining: 1m 52s\n",
            "827:\tlearn: 15.5462642\ttest: 18.2388309\tbest: 18.2388309 (827)\ttotal: 8m 59s\tremaining: 1m 52s\n",
            "828:\tlearn: 15.5277995\ttest: 18.2212891\tbest: 18.2212891 (828)\ttotal: 8m 59s\tremaining: 1m 51s\n",
            "829:\tlearn: 15.5229635\ttest: 18.2200396\tbest: 18.2200396 (829)\ttotal: 9m\tremaining: 1m 50s\n",
            "830:\tlearn: 15.5147944\ttest: 18.2158511\tbest: 18.2158511 (830)\ttotal: 9m\tremaining: 1m 49s\n",
            "831:\tlearn: 15.5115755\ttest: 18.2154431\tbest: 18.2154431 (831)\ttotal: 9m 1s\tremaining: 1m 49s\n",
            "832:\tlearn: 15.5015787\ttest: 18.2146786\tbest: 18.2146786 (832)\ttotal: 9m 2s\tremaining: 1m 48s\n",
            "833:\tlearn: 15.4987414\ttest: 18.2118637\tbest: 18.2118637 (833)\ttotal: 9m 2s\tremaining: 1m 48s\n",
            "834:\tlearn: 15.4949826\ttest: 18.2129918\tbest: 18.2118637 (833)\ttotal: 9m 3s\tremaining: 1m 47s\n",
            "835:\tlearn: 15.4910041\ttest: 18.2123723\tbest: 18.2118637 (833)\ttotal: 9m 3s\tremaining: 1m 46s\n",
            "836:\tlearn: 15.4826766\ttest: 18.2031325\tbest: 18.2031325 (836)\ttotal: 9m 4s\tremaining: 1m 46s\n",
            "837:\tlearn: 15.4814100\ttest: 18.2027249\tbest: 18.2027249 (837)\ttotal: 9m 5s\tremaining: 1m 45s\n",
            "838:\tlearn: 15.4723691\ttest: 18.1876134\tbest: 18.1876134 (838)\ttotal: 9m 5s\tremaining: 1m 44s\n",
            "839:\tlearn: 15.4714545\ttest: 18.1870469\tbest: 18.1870469 (839)\ttotal: 9m 6s\tremaining: 1m 44s\n",
            "840:\tlearn: 15.4649875\ttest: 18.1775792\tbest: 18.1775792 (840)\ttotal: 9m 7s\tremaining: 1m 43s\n",
            "841:\tlearn: 15.4593869\ttest: 18.1748350\tbest: 18.1748350 (841)\ttotal: 9m 8s\tremaining: 1m 42s\n",
            "842:\tlearn: 15.4566285\ttest: 18.1742078\tbest: 18.1742078 (842)\ttotal: 9m 9s\tremaining: 1m 42s\n",
            "843:\tlearn: 15.4518449\ttest: 18.1712863\tbest: 18.1712863 (843)\ttotal: 9m 10s\tremaining: 1m 41s\n",
            "844:\tlearn: 15.4503872\ttest: 18.1706578\tbest: 18.1706578 (844)\ttotal: 9m 10s\tremaining: 1m 41s\n",
            "845:\tlearn: 15.4489688\ttest: 18.1706393\tbest: 18.1706393 (845)\ttotal: 9m 11s\tremaining: 1m 40s\n",
            "846:\tlearn: 15.4437934\ttest: 18.1686757\tbest: 18.1686757 (846)\ttotal: 9m 11s\tremaining: 1m 39s\n",
            "847:\tlearn: 15.4331427\ttest: 18.1528637\tbest: 18.1528637 (847)\ttotal: 9m 12s\tremaining: 1m 39s\n",
            "848:\tlearn: 15.4306426\ttest: 18.1512852\tbest: 18.1512852 (848)\ttotal: 9m 13s\tremaining: 1m 38s\n",
            "849:\tlearn: 15.4257301\ttest: 18.1503561\tbest: 18.1503561 (849)\ttotal: 9m 13s\tremaining: 1m 37s\n",
            "850:\tlearn: 15.4235607\ttest: 18.1495898\tbest: 18.1495898 (850)\ttotal: 9m 14s\tremaining: 1m 37s\n",
            "851:\tlearn: 15.4183495\ttest: 18.1455410\tbest: 18.1455410 (851)\ttotal: 9m 14s\tremaining: 1m 36s\n",
            "852:\tlearn: 15.4141954\ttest: 18.1437325\tbest: 18.1437325 (852)\ttotal: 9m 15s\tremaining: 1m 35s\n",
            "853:\tlearn: 15.4109982\ttest: 18.1445586\tbest: 18.1437325 (852)\ttotal: 9m 15s\tremaining: 1m 35s\n",
            "854:\tlearn: 15.4071222\ttest: 18.1436858\tbest: 18.1436858 (854)\ttotal: 9m 16s\tremaining: 1m 34s\n",
            "855:\tlearn: 15.4036654\ttest: 18.1416695\tbest: 18.1416695 (855)\ttotal: 9m 16s\tremaining: 1m 33s\n",
            "856:\tlearn: 15.4013338\ttest: 18.1412133\tbest: 18.1412133 (856)\ttotal: 9m 17s\tremaining: 1m 33s\n",
            "857:\tlearn: 15.3985040\ttest: 18.1413686\tbest: 18.1412133 (856)\ttotal: 9m 18s\tremaining: 1m 32s\n",
            "858:\tlearn: 15.3915718\ttest: 18.1380331\tbest: 18.1380331 (858)\ttotal: 9m 18s\tremaining: 1m 31s\n",
            "859:\tlearn: 15.3873764\ttest: 18.1359573\tbest: 18.1359573 (859)\ttotal: 9m 19s\tremaining: 1m 31s\n",
            "860:\tlearn: 15.3835418\ttest: 18.1355049\tbest: 18.1355049 (860)\ttotal: 9m 19s\tremaining: 1m 30s\n",
            "861:\tlearn: 15.3795427\ttest: 18.1331601\tbest: 18.1331601 (861)\ttotal: 9m 20s\tremaining: 1m 29s\n",
            "862:\tlearn: 15.3773799\ttest: 18.1292485\tbest: 18.1292485 (862)\ttotal: 9m 21s\tremaining: 1m 29s\n",
            "863:\tlearn: 15.3700106\ttest: 18.1227236\tbest: 18.1227236 (863)\ttotal: 9m 22s\tremaining: 1m 28s\n",
            "864:\tlearn: 15.3693802\ttest: 18.1229242\tbest: 18.1227236 (863)\ttotal: 9m 23s\tremaining: 1m 27s\n",
            "865:\tlearn: 15.3633237\ttest: 18.1191744\tbest: 18.1191744 (865)\ttotal: 9m 24s\tremaining: 1m 27s\n",
            "866:\tlearn: 15.3598313\ttest: 18.1175194\tbest: 18.1175194 (866)\ttotal: 9m 25s\tremaining: 1m 26s\n",
            "867:\tlearn: 15.3527828\ttest: 18.1136864\tbest: 18.1136864 (867)\ttotal: 9m 25s\tremaining: 1m 26s\n",
            "868:\tlearn: 15.3465297\ttest: 18.1083464\tbest: 18.1083464 (868)\ttotal: 9m 26s\tremaining: 1m 25s\n",
            "869:\tlearn: 15.3424296\ttest: 18.1086715\tbest: 18.1083464 (868)\ttotal: 9m 26s\tremaining: 1m 24s\n",
            "870:\tlearn: 15.3361108\ttest: 18.1047641\tbest: 18.1047641 (870)\ttotal: 9m 27s\tremaining: 1m 24s\n",
            "871:\tlearn: 15.3338671\ttest: 18.1038398\tbest: 18.1038398 (871)\ttotal: 9m 27s\tremaining: 1m 23s\n",
            "872:\tlearn: 15.3322093\ttest: 18.1039444\tbest: 18.1038398 (871)\ttotal: 9m 28s\tremaining: 1m 22s\n",
            "873:\tlearn: 15.3280116\ttest: 18.1021713\tbest: 18.1021713 (873)\ttotal: 9m 28s\tremaining: 1m 22s\n",
            "874:\tlearn: 15.3262979\ttest: 18.1004708\tbest: 18.1004708 (874)\ttotal: 9m 29s\tremaining: 1m 21s\n",
            "875:\tlearn: 15.3240535\ttest: 18.0987014\tbest: 18.0987014 (875)\ttotal: 9m 30s\tremaining: 1m 20s\n",
            "876:\tlearn: 15.3211233\ttest: 18.0982805\tbest: 18.0982805 (876)\ttotal: 9m 30s\tremaining: 1m 20s\n",
            "877:\tlearn: 15.3171944\ttest: 18.0999238\tbest: 18.0982805 (876)\ttotal: 9m 31s\tremaining: 1m 19s\n",
            "878:\tlearn: 15.3136991\ttest: 18.0978367\tbest: 18.0978367 (878)\ttotal: 9m 31s\tremaining: 1m 18s\n",
            "879:\tlearn: 15.3118424\ttest: 18.0972273\tbest: 18.0972273 (879)\ttotal: 9m 32s\tremaining: 1m 18s\n",
            "880:\tlearn: 15.3104290\ttest: 18.0969964\tbest: 18.0969964 (880)\ttotal: 9m 32s\tremaining: 1m 17s\n",
            "881:\tlearn: 15.3079970\ttest: 18.0967161\tbest: 18.0967161 (881)\ttotal: 9m 33s\tremaining: 1m 16s\n",
            "882:\tlearn: 15.3029043\ttest: 18.0911873\tbest: 18.0911873 (882)\ttotal: 9m 34s\tremaining: 1m 16s\n",
            "883:\tlearn: 15.2991771\ttest: 18.0881458\tbest: 18.0881458 (883)\ttotal: 9m 34s\tremaining: 1m 15s\n",
            "884:\tlearn: 15.2985577\ttest: 18.0878933\tbest: 18.0878933 (884)\ttotal: 9m 35s\tremaining: 1m 14s\n",
            "885:\tlearn: 15.2964080\ttest: 18.0862356\tbest: 18.0862356 (885)\ttotal: 9m 36s\tremaining: 1m 14s\n",
            "886:\tlearn: 15.2943065\ttest: 18.0848639\tbest: 18.0848639 (886)\ttotal: 9m 37s\tremaining: 1m 13s\n",
            "887:\tlearn: 15.2903489\ttest: 18.0826725\tbest: 18.0826725 (887)\ttotal: 9m 38s\tremaining: 1m 12s\n",
            "888:\tlearn: 15.2870763\ttest: 18.0820426\tbest: 18.0820426 (888)\ttotal: 9m 39s\tremaining: 1m 12s\n",
            "889:\tlearn: 15.2860259\ttest: 18.0811917\tbest: 18.0811917 (889)\ttotal: 9m 39s\tremaining: 1m 11s\n",
            "890:\tlearn: 15.2853401\ttest: 18.0806271\tbest: 18.0806271 (890)\ttotal: 9m 40s\tremaining: 1m 10s\n",
            "891:\tlearn: 15.2846135\ttest: 18.0804664\tbest: 18.0804664 (891)\ttotal: 9m 40s\tremaining: 1m 10s\n",
            "892:\tlearn: 15.2826366\ttest: 18.0788824\tbest: 18.0788824 (892)\ttotal: 9m 41s\tremaining: 1m 9s\n",
            "893:\tlearn: 15.2741558\ttest: 18.0647560\tbest: 18.0647560 (893)\ttotal: 9m 41s\tremaining: 1m 8s\n",
            "894:\tlearn: 15.2699703\ttest: 18.0616827\tbest: 18.0616827 (894)\ttotal: 9m 42s\tremaining: 1m 8s\n",
            "895:\tlearn: 15.2672010\ttest: 18.0595028\tbest: 18.0595028 (895)\ttotal: 9m 42s\tremaining: 1m 7s\n",
            "896:\tlearn: 15.2634400\ttest: 18.0582455\tbest: 18.0582455 (896)\ttotal: 9m 43s\tremaining: 1m 7s\n",
            "897:\tlearn: 15.2604074\ttest: 18.0575631\tbest: 18.0575631 (897)\ttotal: 9m 44s\tremaining: 1m 6s\n",
            "898:\tlearn: 15.2532880\ttest: 18.0495030\tbest: 18.0495030 (898)\ttotal: 9m 44s\tremaining: 1m 5s\n",
            "899:\tlearn: 15.2522665\ttest: 18.0490367\tbest: 18.0490367 (899)\ttotal: 9m 45s\tremaining: 1m 5s\n",
            "900:\tlearn: 15.2508305\ttest: 18.0490069\tbest: 18.0490069 (900)\ttotal: 9m 46s\tremaining: 1m 4s\n",
            "901:\tlearn: 15.2472915\ttest: 18.0450079\tbest: 18.0450079 (901)\ttotal: 9m 46s\tremaining: 1m 3s\n",
            "902:\tlearn: 15.2460328\ttest: 18.0450771\tbest: 18.0450079 (901)\ttotal: 9m 47s\tremaining: 1m 3s\n",
            "903:\tlearn: 15.2437567\ttest: 18.0439420\tbest: 18.0439420 (903)\ttotal: 9m 47s\tremaining: 1m 2s\n",
            "904:\tlearn: 15.2426354\ttest: 18.0437307\tbest: 18.0437307 (904)\ttotal: 9m 48s\tremaining: 1m 1s\n",
            "905:\tlearn: 15.2422438\ttest: 18.0435399\tbest: 18.0435399 (905)\ttotal: 9m 49s\tremaining: 1m 1s\n",
            "906:\tlearn: 15.2405957\ttest: 18.0431913\tbest: 18.0431913 (906)\ttotal: 9m 49s\tremaining: 1m\n",
            "907:\tlearn: 15.2372441\ttest: 18.0394228\tbest: 18.0394228 (907)\ttotal: 9m 50s\tremaining: 59.9s\n",
            "908:\tlearn: 15.2371472\ttest: 18.0395115\tbest: 18.0394228 (907)\ttotal: 9m 51s\tremaining: 59.2s\n",
            "909:\tlearn: 15.2339330\ttest: 18.0387719\tbest: 18.0387719 (909)\ttotal: 9m 52s\tremaining: 58.6s\n",
            "910:\tlearn: 15.2295965\ttest: 18.0373824\tbest: 18.0373824 (910)\ttotal: 9m 53s\tremaining: 58s\n",
            "911:\tlearn: 15.2282640\ttest: 18.0366805\tbest: 18.0366805 (911)\ttotal: 9m 54s\tremaining: 57.4s\n",
            "912:\tlearn: 15.2262139\ttest: 18.0364663\tbest: 18.0364663 (912)\ttotal: 9m 54s\tremaining: 56.7s\n",
            "913:\tlearn: 15.2245106\ttest: 18.0379021\tbest: 18.0364663 (912)\ttotal: 9m 55s\tremaining: 56s\n",
            "914:\tlearn: 15.2210251\ttest: 18.0376410\tbest: 18.0364663 (912)\ttotal: 9m 56s\tremaining: 55.4s\n",
            "915:\tlearn: 15.2120035\ttest: 18.0303691\tbest: 18.0303691 (915)\ttotal: 9m 56s\tremaining: 54.7s\n",
            "916:\tlearn: 15.2022696\ttest: 18.0273734\tbest: 18.0273734 (916)\ttotal: 9m 57s\tremaining: 54.1s\n",
            "917:\tlearn: 15.1995140\ttest: 18.0284024\tbest: 18.0273734 (916)\ttotal: 9m 57s\tremaining: 53.4s\n",
            "918:\tlearn: 15.1979458\ttest: 18.0288209\tbest: 18.0273734 (916)\ttotal: 9m 58s\tremaining: 52.7s\n",
            "919:\tlearn: 15.1958320\ttest: 18.0295610\tbest: 18.0273734 (916)\ttotal: 9m 59s\tremaining: 52.1s\n",
            "920:\tlearn: 15.1931361\ttest: 18.0287873\tbest: 18.0273734 (916)\ttotal: 9m 59s\tremaining: 51.4s\n",
            "921:\tlearn: 15.1914454\ttest: 18.0300953\tbest: 18.0273734 (916)\ttotal: 10m\tremaining: 50.8s\n",
            "922:\tlearn: 15.1893691\ttest: 18.0294079\tbest: 18.0273734 (916)\ttotal: 10m\tremaining: 50.1s\n",
            "923:\tlearn: 15.1838280\ttest: 18.0289047\tbest: 18.0273734 (916)\ttotal: 10m 1s\tremaining: 49.5s\n",
            "924:\tlearn: 15.1829012\ttest: 18.0288562\tbest: 18.0273734 (916)\ttotal: 10m 2s\tremaining: 48.8s\n",
            "925:\tlearn: 15.1793272\ttest: 18.0284481\tbest: 18.0273734 (916)\ttotal: 10m 2s\tremaining: 48.2s\n",
            "926:\tlearn: 15.1777852\ttest: 18.0286898\tbest: 18.0273734 (916)\ttotal: 10m 3s\tremaining: 47.5s\n",
            "927:\tlearn: 15.1761624\ttest: 18.0286376\tbest: 18.0273734 (916)\ttotal: 10m 4s\tremaining: 46.9s\n",
            "928:\tlearn: 15.1732966\ttest: 18.0287909\tbest: 18.0273734 (916)\ttotal: 10m 4s\tremaining: 46.2s\n",
            "929:\tlearn: 15.1695519\ttest: 18.0286939\tbest: 18.0273734 (916)\ttotal: 10m 5s\tremaining: 45.6s\n",
            "930:\tlearn: 15.1654883\ttest: 18.0289200\tbest: 18.0273734 (916)\ttotal: 10m 6s\tremaining: 45s\n",
            "931:\tlearn: 15.1622077\ttest: 18.0284018\tbest: 18.0273734 (916)\ttotal: 10m 7s\tremaining: 44.4s\n",
            "932:\tlearn: 15.1571639\ttest: 18.0218502\tbest: 18.0218502 (932)\ttotal: 10m 8s\tremaining: 43.7s\n",
            "933:\tlearn: 15.1561587\ttest: 18.0215133\tbest: 18.0215133 (933)\ttotal: 10m 9s\tremaining: 43s\n",
            "934:\tlearn: 15.1496146\ttest: 18.0209742\tbest: 18.0209742 (934)\ttotal: 10m 9s\tremaining: 42.4s\n",
            "935:\tlearn: 15.1495410\ttest: 18.0210377\tbest: 18.0209742 (934)\ttotal: 10m 10s\tremaining: 41.8s\n",
            "936:\tlearn: 15.1398015\ttest: 18.0138338\tbest: 18.0138338 (936)\ttotal: 10m 12s\tremaining: 41.2s\n",
            "937:\tlearn: 15.1338934\ttest: 18.0086291\tbest: 18.0086291 (937)\ttotal: 10m 13s\tremaining: 40.5s\n",
            "938:\tlearn: 15.1310121\ttest: 18.0073076\tbest: 18.0073076 (938)\ttotal: 10m 13s\tremaining: 39.9s\n",
            "939:\tlearn: 15.1292416\ttest: 18.0070173\tbest: 18.0070173 (939)\ttotal: 10m 14s\tremaining: 39.2s\n",
            "940:\tlearn: 15.1247910\ttest: 18.0020589\tbest: 18.0020589 (940)\ttotal: 10m 14s\tremaining: 38.5s\n",
            "941:\tlearn: 15.1237271\ttest: 18.0012998\tbest: 18.0012998 (941)\ttotal: 10m 15s\tremaining: 37.9s\n",
            "942:\tlearn: 15.1231813\ttest: 18.0011352\tbest: 18.0011352 (942)\ttotal: 10m 15s\tremaining: 37.2s\n",
            "943:\tlearn: 15.1218173\ttest: 18.0013267\tbest: 18.0011352 (942)\ttotal: 10m 16s\tremaining: 36.6s\n",
            "944:\tlearn: 15.1208354\ttest: 17.9998980\tbest: 17.9998980 (944)\ttotal: 10m 16s\tremaining: 35.9s\n",
            "945:\tlearn: 15.1200954\ttest: 17.9990786\tbest: 17.9990786 (945)\ttotal: 10m 17s\tremaining: 35.3s\n",
            "946:\tlearn: 15.1187570\ttest: 17.9990191\tbest: 17.9990191 (946)\ttotal: 10m 18s\tremaining: 34.6s\n",
            "947:\tlearn: 15.1146643\ttest: 17.9838345\tbest: 17.9838345 (947)\ttotal: 10m 19s\tremaining: 34s\n",
            "948:\tlearn: 15.1071524\ttest: 17.9785034\tbest: 17.9785034 (948)\ttotal: 10m 20s\tremaining: 33.4s\n",
            "949:\tlearn: 15.1005243\ttest: 17.9741141\tbest: 17.9741141 (949)\ttotal: 10m 21s\tremaining: 32.7s\n",
            "950:\tlearn: 15.0961697\ttest: 17.9713669\tbest: 17.9713669 (950)\ttotal: 10m 22s\tremaining: 32.1s\n",
            "951:\tlearn: 15.0917272\ttest: 17.9684370\tbest: 17.9684370 (951)\ttotal: 10m 22s\tremaining: 31.4s\n",
            "952:\tlearn: 15.0870175\ttest: 17.9622320\tbest: 17.9622320 (952)\ttotal: 10m 23s\tremaining: 30.8s\n",
            "953:\tlearn: 15.0857302\ttest: 17.9623757\tbest: 17.9622320 (952)\ttotal: 10m 24s\tremaining: 30.1s\n",
            "954:\tlearn: 15.0839912\ttest: 17.9620422\tbest: 17.9620422 (954)\ttotal: 10m 24s\tremaining: 29.4s\n",
            "955:\tlearn: 15.0825540\ttest: 17.9636255\tbest: 17.9620422 (954)\ttotal: 10m 25s\tremaining: 28.8s\n",
            "956:\tlearn: 15.0801221\ttest: 17.9632336\tbest: 17.9620422 (954)\ttotal: 10m 25s\tremaining: 28.1s\n",
            "957:\tlearn: 15.0777785\ttest: 17.9623942\tbest: 17.9620422 (954)\ttotal: 10m 26s\tremaining: 27.5s\n",
            "958:\tlearn: 15.0749644\ttest: 17.9603722\tbest: 17.9603722 (958)\ttotal: 10m 26s\tremaining: 26.8s\n",
            "959:\tlearn: 15.0715112\ttest: 17.9590419\tbest: 17.9590419 (959)\ttotal: 10m 27s\tremaining: 26.1s\n",
            "960:\tlearn: 15.0669571\ttest: 17.9599079\tbest: 17.9590419 (959)\ttotal: 10m 27s\tremaining: 25.5s\n",
            "961:\tlearn: 15.0654025\ttest: 17.9601026\tbest: 17.9590419 (959)\ttotal: 10m 28s\tremaining: 24.8s\n",
            "962:\tlearn: 15.0639493\ttest: 17.9595589\tbest: 17.9590419 (959)\ttotal: 10m 29s\tremaining: 24.2s\n",
            "963:\tlearn: 15.0512693\ttest: 17.9325038\tbest: 17.9325038 (963)\ttotal: 10m 29s\tremaining: 23.5s\n",
            "964:\tlearn: 15.0483364\ttest: 17.9315895\tbest: 17.9315895 (964)\ttotal: 10m 30s\tremaining: 22.9s\n",
            "965:\tlearn: 15.0479026\ttest: 17.9319581\tbest: 17.9315895 (964)\ttotal: 10m 30s\tremaining: 22.2s\n",
            "966:\tlearn: 15.0451413\ttest: 17.9311610\tbest: 17.9311610 (966)\ttotal: 10m 31s\tremaining: 21.5s\n",
            "967:\tlearn: 15.0427618\ttest: 17.9294833\tbest: 17.9294833 (967)\ttotal: 10m 31s\tremaining: 20.9s\n",
            "968:\tlearn: 15.0406601\ttest: 17.9287641\tbest: 17.9287641 (968)\ttotal: 10m 32s\tremaining: 20.2s\n",
            "969:\tlearn: 15.0390695\ttest: 17.9288133\tbest: 17.9287641 (968)\ttotal: 10m 33s\tremaining: 19.6s\n",
            "970:\tlearn: 15.0387015\ttest: 17.9289027\tbest: 17.9287641 (968)\ttotal: 10m 34s\tremaining: 19s\n",
            "971:\tlearn: 15.0376298\ttest: 17.9285146\tbest: 17.9285146 (971)\ttotal: 10m 35s\tremaining: 18.3s\n",
            "972:\tlearn: 15.0366437\ttest: 17.9280542\tbest: 17.9280542 (972)\ttotal: 10m 36s\tremaining: 17.7s\n",
            "973:\tlearn: 15.0334737\ttest: 17.9250176\tbest: 17.9250176 (973)\ttotal: 10m 37s\tremaining: 17s\n",
            "974:\tlearn: 15.0325202\ttest: 17.9259790\tbest: 17.9250176 (973)\ttotal: 10m 37s\tremaining: 16.4s\n",
            "975:\tlearn: 15.0263652\ttest: 17.9185553\tbest: 17.9185553 (975)\ttotal: 10m 38s\tremaining: 15.7s\n",
            "976:\tlearn: 15.0252329\ttest: 17.9185480\tbest: 17.9185480 (976)\ttotal: 10m 38s\tremaining: 15s\n",
            "977:\tlearn: 15.0194342\ttest: 17.9147250\tbest: 17.9147250 (977)\ttotal: 10m 39s\tremaining: 14.4s\n",
            "978:\tlearn: 15.0167315\ttest: 17.9137024\tbest: 17.9137024 (978)\ttotal: 10m 39s\tremaining: 13.7s\n",
            "979:\tlearn: 15.0111576\ttest: 17.9119887\tbest: 17.9119887 (979)\ttotal: 10m 40s\tremaining: 13.1s\n",
            "980:\tlearn: 15.0105387\ttest: 17.9121771\tbest: 17.9119887 (979)\ttotal: 10m 41s\tremaining: 12.4s\n",
            "981:\tlearn: 15.0097828\ttest: 17.9120719\tbest: 17.9119887 (979)\ttotal: 10m 41s\tremaining: 11.8s\n",
            "982:\tlearn: 15.0087081\ttest: 17.9120357\tbest: 17.9119887 (979)\ttotal: 10m 42s\tremaining: 11.1s\n",
            "983:\tlearn: 15.0058513\ttest: 17.9110852\tbest: 17.9110852 (983)\ttotal: 10m 42s\tremaining: 10.5s\n",
            "984:\tlearn: 15.0057733\ttest: 17.9111532\tbest: 17.9110852 (983)\ttotal: 10m 43s\tremaining: 9.8s\n",
            "985:\tlearn: 15.0040598\ttest: 17.9109901\tbest: 17.9109901 (985)\ttotal: 10m 44s\tremaining: 9.14s\n",
            "986:\tlearn: 14.9971787\ttest: 17.9069467\tbest: 17.9069467 (986)\ttotal: 10m 44s\tremaining: 8.49s\n",
            "987:\tlearn: 14.9968903\ttest: 17.9072035\tbest: 17.9069467 (986)\ttotal: 10m 45s\tremaining: 7.84s\n",
            "988:\tlearn: 14.9865773\ttest: 17.8728513\tbest: 17.8728513 (988)\ttotal: 10m 45s\tremaining: 7.18s\n",
            "989:\tlearn: 14.9859751\ttest: 17.8726813\tbest: 17.8726813 (989)\ttotal: 10m 46s\tremaining: 6.53s\n",
            "990:\tlearn: 14.9815637\ttest: 17.8716809\tbest: 17.8716809 (990)\ttotal: 10m 46s\tremaining: 5.88s\n",
            "991:\tlearn: 14.9749718\ttest: 17.8665112\tbest: 17.8665112 (991)\ttotal: 10m 47s\tremaining: 5.22s\n",
            "992:\tlearn: 14.9729137\ttest: 17.8667400\tbest: 17.8665112 (991)\ttotal: 10m 48s\tremaining: 4.57s\n",
            "993:\tlearn: 14.9712627\ttest: 17.8661543\tbest: 17.8661543 (993)\ttotal: 10m 49s\tremaining: 3.92s\n",
            "994:\tlearn: 14.9632962\ttest: 17.8509984\tbest: 17.8509984 (994)\ttotal: 10m 50s\tremaining: 3.27s\n",
            "995:\tlearn: 14.9600554\ttest: 17.8490813\tbest: 17.8490813 (995)\ttotal: 10m 51s\tremaining: 2.62s\n",
            "996:\tlearn: 14.9575774\ttest: 17.8490860\tbest: 17.8490813 (995)\ttotal: 10m 52s\tremaining: 1.96s\n",
            "997:\tlearn: 14.9550276\ttest: 17.8443440\tbest: 17.8443440 (997)\ttotal: 10m 52s\tremaining: 1.31s\n",
            "998:\tlearn: 14.9491171\ttest: 17.8398499\tbest: 17.8398499 (998)\ttotal: 10m 53s\tremaining: 654ms\n",
            "999:\tlearn: 14.9466267\ttest: 17.8389584\tbest: 17.8389584 (999)\ttotal: 10m 53s\tremaining: 0us\n",
            "\n",
            "bestTest = 17.83895838\n",
            "bestIteration = 999\n",
            "\n"
          ]
        },
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "<catboost.core.CatBoostRegressor at 0x79f57a983f90>"
            ]
          },
          "metadata": {},
          "execution_count": 31
        }
      ],
      "source": [
        "# 모델 학습하기\n",
        "model = CatBoostRegressor(\n",
        ")\n",
        "\n",
        "model.fit(\n",
        "    x_train, y_train,\n",
        "    eval_set=(x_val, y_val),\n",
        "    cat_features=cat_features,\n",
        "    use_best_model=True,\n",
        "    early_stopping_rounds=100\n",
        ")"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 32,
      "metadata": {
        "id": "j2ukGn9AACOZ",
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "624b49f4-85d3-4f86-bce9-9948df7623aa"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Validation RMSE: 17.8390\n"
          ]
        }
      ],
      "source": [
        "y_pred = model.predict(x_val)\n",
        "\n",
        "rmse = np.sqrt(mean_squared_error(y_val, y_pred))\n",
        "print(f\"Validation RMSE: {rmse:.4f}\")"
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "# Feature Importance"
      ],
      "metadata": {
        "id": "6e-8Cnwfw9nu"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "import pandas as pd\n",
        "from catboost import Pool\n",
        "\n",
        "val_pool = Pool(\n",
        "    data=x_val,\n",
        "    label=y_val,\n",
        "    cat_features=cat_features\n",
        ")\n",
        "\n",
        "importances = model.get_feature_importance(data=val_pool, type='LossFunctionChange')\n",
        "\n",
        "fi_df = pd.DataFrame({\n",
        "    'feature': features,\n",
        "    'importance': importances\n",
        "}).sort_values('importance', ascending=False)\n",
        "\n",
        "print(\"===== Feature Importance =====\")\n",
        "print(fi_df)\n",
        "\n",
        "fi_df.to_csv(\"feature_importance.csv\", index=False, encoding=\"utf-8-sig\")\n",
        "print(\"Feature importance saved to feature_importance.csv\")\n"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "Giz4ZjQQSq9o",
        "outputId": "4286c453-18d7-4db7-a514-a1911877933f"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "===== Feature Importance =====\n",
            "                 feature  importance\n",
            "27                  X_27    1.772152\n",
            "38  predict_date_weekday    1.106058\n",
            "28              영업장명_메뉴명    0.716439\n",
            "23                  X_23    0.629193\n",
            "22                  X_22    0.598292\n",
            "26                  X_26    0.460992\n",
            "37      predict_date_day    0.455413\n",
            "29            store_name    0.376908\n",
            "36    predict_date_month    0.312247\n",
            "25                  X_25    0.310966\n",
            "21                  X_21    0.294382\n",
            "24                  X_24    0.290373\n",
            "31      start_date_month    0.257912\n",
            "30             menu_name    0.223057\n",
            "39  predict_date_holiday    0.135629\n",
            "40  predict_date_quarter    0.128724\n",
            "35    start_date_quarter    0.088987\n",
            "19                  X_19    0.047899\n",
            "33    start_date_weekday    0.029102\n",
            "0                    X_0    0.028175\n",
            "16                  X_16    0.023644\n",
            "15                  X_15    0.021625\n",
            "18                  X_18    0.018597\n",
            "32        start_date_day    0.016750\n",
            "13                  X_13    0.014898\n",
            "4                    X_4    0.013551\n",
            "11                  X_11    0.012543\n",
            "41   predict_date_offset    0.011692\n",
            "10                  X_10    0.011654\n",
            "5                    X_5    0.008852\n",
            "12                  X_12    0.008339\n",
            "20                  X_20    0.006987\n",
            "8                    X_8    0.006890\n",
            "6                    X_6    0.004663\n",
            "9                    X_9    0.004641\n",
            "1                    X_1    0.004478\n",
            "2                    X_2    0.004368\n",
            "3                    X_3    0.002889\n",
            "17                  X_17    0.000639\n",
            "34    start_date_holiday    0.000445\n",
            "7                    X_7   -0.000366\n",
            "14                  X_14   -0.004827\n",
            "Feature importance saved to feature_importance.csv\n"
          ]
        }
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "# 제출 평가 산식"
      ],
      "metadata": {
        "id": "fHcPZzCtRkp_"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "y_pred = model.predict(x_val)\n",
        "\n",
        "x_val[\"predict\"] = y_pred\n",
        "x_val[\"target\"] = y_val\n",
        "\n",
        "score = 0\n",
        "for store_name in list(x_val[\"store_name\"].unique()):\n",
        "    score_store = 0\n",
        "    df_store = x_val[x_val[\"store_name\"]==store_name].copy()\n",
        "\n",
        "    for menu_name in list(df_store[\"menu_name\"].unique()):\n",
        "        score_store_menu = 0\n",
        "        df_store_menu = df_store[df_store[\"menu_name\"]==menu_name].copy()\n",
        "        df_store_menu = df_store_menu[df_store_menu[\"target\"]!=0]\n",
        "\n",
        "        for i in range(len(df_store_menu)):\n",
        "            A = df_store_menu[\"target\"].iloc[i]\n",
        "            P = df_store_menu[\"predict\"].iloc[i]\n",
        "            score_store_menu += 2*abs(A-P)/(abs(A)+abs(P))\n",
        "\n",
        "\n",
        "        score_store += score_store_menu/len(df_store_menu)\n",
        "\n",
        "    score += score_store / len(list(df_store[\"menu_name\"].unique()))\n",
        "    if store_name in ['미라시아', '담하']:\n",
        "        score += score_store / len(list(df_store[\"menu_name\"].unique()))\n",
        "score = score / (len(list(x_val[\"store_name\"].unique()))+2)\n",
        "\n",
        "print(score)\n"
      ],
      "metadata": {
        "id": "QwbZ_ET5RmzA",
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "5ad2ee21-5fe4-4a06-b524-740859a4f60a"
      },
      "execution_count": 33,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "0.5201084432371393\n"
          ]
        }
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "VA29HpigwUnR"
      },
      "source": [
        "# Prediction"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 34,
      "metadata": {
        "id": "NCdEBk09bIDb"
      },
      "outputs": [],
      "source": [
        "def make_expanded_test(df, test_prefix):\n",
        "    df = df.sort_values(['영업장명_메뉴명', '영업일자'])\n",
        "    df['영업일자'] = pd.to_datetime(df['영업일자'])\n",
        "\n",
        "    result = []\n",
        "\n",
        "    for name, group in df.groupby('영업장명_메뉴명'):\n",
        "        group = group.sort_values('영업일자')\n",
        "        sales = group['매출수량'].values\n",
        "        dates = group['영업일자'].values\n",
        "        store_name = group['영업장명'].iloc[0]\n",
        "        menu_name = group['메뉴명'].iloc[0]\n",
        "\n",
        "        start_date = dates[0]\n",
        "\n",
        "        for j in range(7):\n",
        "            predict_date = start_date + pd.Timedelta(days=28 + j)\n",
        "\n",
        "            result.append({\n",
        "                '영업장명_메뉴명': name,\n",
        "                '영업일자':f\"{test_prefix}+{j+1}일\",\n",
        "                'store_name': store_name,\n",
        "                'menu_name': menu_name,\n",
        "                'start_date': start_date,\n",
        "                **{f'X_{k}': sales[k] for k in range(28)},\n",
        "                'predict_date': predict_date,\n",
        "                'predict_date_offset': j + 1\n",
        "            })\n",
        "\n",
        "    df_result = pd.DataFrame(result)\n",
        "\n",
        "    df_result.insert(df_result.columns.get_loc('start_date') + 1, 'start_date_year', df_result['start_date'].dt.year)\n",
        "    df_result.insert(df_result.columns.get_loc('start_date') + 2, 'start_date_month', df_result['start_date'].dt.month)\n",
        "    df_result.insert(df_result.columns.get_loc('start_date') + 3, 'start_date_day', df_result['start_date'].dt.day)\n",
        "    df_result.insert(df_result.columns.get_loc('start_date') + 4, 'start_date_weekday', df_result['start_date'].dt.day_name())\n",
        "    df_result.insert(df_result.columns.get_loc('start_date') + 5, 'start_date_holiday', df_result['start_date'].dt.date.isin(holidays.KR(years=[2023, 2024, 2025])).astype(int))\n",
        "    df_result.insert(df_result.columns.get_loc('start_date') + 6, 'start_date_quarter', df_result['start_date'].dt.quarter)\n",
        "\n",
        "    df_result.insert(df_result.columns.get_loc('predict_date') + 1, 'predict_date_year', df_result['predict_date'].dt.year)\n",
        "    df_result.insert(df_result.columns.get_loc('predict_date') + 2, 'predict_date_month', df_result['predict_date'].dt.month)\n",
        "    df_result.insert(df_result.columns.get_loc('predict_date') + 3, 'predict_date_day', df_result['predict_date'].dt.day)\n",
        "    df_result.insert(df_result.columns.get_loc('predict_date') + 4, 'predict_date_weekday', df_result['predict_date'].dt.day_name())\n",
        "    df_result.insert(df_result.columns.get_loc('predict_date') + 5, 'predict_date_holiday', df_result['predict_date'].dt.date.isin(holidays.KR(years=[2023, 2024, 2025])).astype(int))\n",
        "    df_result.insert(df_result.columns.get_loc('predict_date') + 6, 'predict_date_quarter', df_result['predict_date'].dt.quarter)\n",
        "\n",
        "    return df_result\n"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 35,
      "metadata": {
        "id": "blLe62VNaG-w"
      },
      "outputs": [],
      "source": [
        "df_test_list = []\n",
        "\n",
        "test_files = sorted(glob.glob('/content/TEST_*.csv'))\n",
        "\n",
        "for path in test_files:\n",
        "    test_data = pd.read_csv(path, encoding='utf-8-sig')\n",
        "\n",
        "    test_data = test_data.sort_values(['영업장명_메뉴명', '영업일자'])\n",
        "    test_data['영업일자'] = pd.to_datetime(test_data['영업일자'])\n",
        "\n",
        "    test_data['요일'] = test_data['영업일자'].dt.day_name()\n",
        "\n",
        "    test_data[['영업장명', '메뉴명']] = test_data['영업장명_메뉴명'].str.split('_', n=1, expand=True)\n",
        "\n",
        "    filename = os.path.basename(path)\n",
        "    test_prefix = re.search(r'(TEST_\\d+)', filename).group(1)\n",
        "\n",
        "    df_temp = make_expanded_test(test_data.copy(), test_prefix)\n",
        "\n",
        "    df_test_list.append(df_temp)\n",
        "\n",
        "df_test = pd.concat(df_test_list, ignore_index=True)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 36,
      "metadata": {
        "id": "xD8YYDTuf2wl"
      },
      "outputs": [],
      "source": [
        "x_test = df_test[features]\n",
        "y_test = model.predict(x_test)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 37,
      "metadata": {
        "id": "bE3z7zNaaG8h"
      },
      "outputs": [],
      "source": [
        "df_test['매출수량'] = y_test"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "geQlGYoJk3Aw"
      },
      "source": [
        "# Submission"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 38,
      "metadata": {
        "id": "ZGfObQEbbjgY"
      },
      "outputs": [],
      "source": [
        "def convert_to_submission_format(pred_df: pd.DataFrame, sample_submission: pd.DataFrame):\n",
        "    # (영업일자, 메뉴) → 매출수량 딕셔너리로 변환\n",
        "    pred_dict = dict(zip(\n",
        "        zip(pred_df['영업일자'], pred_df['영업장명_메뉴명']),\n",
        "        pred_df['매출수량']\n",
        "    ))\n",
        "\n",
        "    final_df = sample_submission.copy()\n",
        "\n",
        "    for col in final_df.columns[1:]:\n",
        "      final_df[col] = final_df[col].astype(float)\n",
        "\n",
        "    for row_idx in final_df.index:\n",
        "        date = final_df.loc[row_idx, '영업일자']\n",
        "        for col in final_df.columns[1:]:\n",
        "            final_df.loc[row_idx, col] = max(0, pred_dict.get((date, col), 0)) # 0보다 작으면 그냥 0으로 만듬\n",
        "\n",
        "    return final_df"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 39,
      "metadata": {
        "id": "5dkY01Yrbjiw"
      },
      "outputs": [],
      "source": [
        "sample_submission = pd.read_csv('/content/sample_submission.csv')\n",
        "submission = convert_to_submission_format(df_test, sample_submission)\n",
        "submission.to_csv('/content/submission.csv', index=False, encoding='utf-8-sig')"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "OdGu-vQJbjky"
      },
      "outputs": [],
      "source": []
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "1yhAcS7AbjnA"
      },
      "outputs": [],
      "source": []
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "luHDL74lbjpD"
      },
      "outputs": [],
      "source": []
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "b_eWowULbjrB"
      },
      "outputs": [],
      "source": []
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "XLyRmCyXbgxY"
      },
      "outputs": [],
      "source": []
    }
  ],
  "metadata": {
    "accelerator": "GPU",
    "colab": {
      "gpuType": "T4",
      "provenance": []
    },
    "kernelspec": {
      "display_name": "Python 3",
      "name": "python3"
    },
    "language_info": {
      "codemirror_mode": {
        "name": "ipython",
        "version": 3
      },
      "file_extension": ".py",
      "mimetype": "text/x-python",
      "name": "python",
      "nbconvert_exporter": "python",
      "pygments_lexer": "ipython3",
      "version": "3.8.18"
    }
  },
  "nbformat": 4,
  "nbformat_minor": 0
}
